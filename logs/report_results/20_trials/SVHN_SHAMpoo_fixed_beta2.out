/var/spool/slurmd/job21167/slurm_script: line 15: cd: HeavyBall: No such file or directory
Current directory /home/tomjodrell/HeavyBall
CUDA_VISIBLE_DEVICES 1
/home/tomjodrell/HeavyBall/benchmark/benchmark_runner.py:289: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
  plt.legend()
Running comparison for SVHN
Optimizers: ExternalDistributedShampoo
Runs per optimizer: 3
Steps per run: 0
Optuna trials per run: 20

=== Running ExternalDistributedShampoo ===
Run 1/3
running ExternalDistributedShampoo
Running: python -m benchmark.SVHN --opt ExternalDistributedShampoo --steps 0 --trials 20 --runtime-limit 744 --step-hint 27000
{'runtime': 15180.103330373764, 'attempts': 1, 'best_loss': 0.948640135218193, 'loss_trajectory': [2.3385214805603027, 0.4838574528694153, 0.36636048555374146, 0.3262588679790497, 0.2150798738002777, 0.19947661459445953, 0.23887720704078674, 0.14416803419589996, 0.2586807608604431, 0.11779634654521942, 0.2564060389995575, 0.1386418342590332, 0.18956215679645538, 0.06855728477239609, 0.2522605359554291, 0.14788153767585754, 0.26656705141067505, 0.09764581173658371, 0.21647654473781586, 0.19970715045928955, 0.31471583247184753, 0.12014724314212799, 0.12961970269680023, 0.3914710581302643, 0.07086464017629623, 0.18790173530578613, 0.14728303253650665, 0.04215128347277641], 'test_accuracies': [0.06127074370006146, 0.8190688383527965, 0.8817609096496619, 0.9242086662569146, 0.9334665027658267, 0.9338122311001844, 0.9401121696373694, 0.9453749231714813, 0.9452596803933621, 0.943300553165335, 0.948640135218193, 0.9388444990780578, 0.93799938537185, 0.9360786724031961, 0.9363091579594346, 0.948179164105716, 0.9415334972341733, 0.9456822372464659, 0.9427243392747388, 0.9461432083589428, 0.9451060233558697, 0.9470651505838967, 0.9378457283343578, 0.9339658881376767, 0.9451828518746158, 0.9422633681622619, 0.936539643515673, 0.9426090964966195], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 0, 'optimizer': 'ExternalDistributedShampoo', 'seed': 42, 'trials': 20, 'log_file': 'comparison_results/run_ExternalDistributedShampoo_42_1756331360735.log', 'success': True}
  ✓ Success - Loss: 0.948640135218193
Run 2/3
running ExternalDistributedShampoo
Running: python -m benchmark.SVHN --opt ExternalDistributedShampoo --steps 0 --trials 20 --runtime-limit 744 --step-hint 27000
{'runtime': 15071.296667337418, 'attempts': 1, 'best_loss': 0.9478718500307314, 'loss_trajectory': [2.2955434322357178, 0.6666679978370667, 0.37810611724853516, 0.17979338765144348, 0.20828227698802948, 0.2508348226547241, 0.1420605331659317, 0.3184874951839447, 0.1438504010438919, 0.19763053953647614, 0.13865633308887482, 0.16687354445457458, 0.10698220878839493, 0.205398827791214, 0.14281074702739716, 0.2571159899234772, 0.10566263645887375, 0.2721211016178131, 0.19719278812408447, 0.3214203119277954, 0.18568558990955353, 0.12019415199756622, 0.4299827218055725, 0.08223355561494827, 0.2324034422636032, 0.12274790555238724, 0.025302521884441376, 0.043337322771549225], 'test_accuracies': [0.07755838967424708, 0.8244084204056545, 0.909841733251383, 0.9272433927473879, 0.9313153042409342, 0.9409188690842041, 0.9454517516902274, 0.9478718500307314, 0.9449907805777504, 0.946681007990166, 0.9434157959434543, 0.9429164105716041, 0.9420328826060234, 0.946181622618316, 0.9455285802089736, 0.942839582052858, 0.9426475107559926, 0.9441840811309158, 0.9463736939151813, 0.9420712968653965, 0.9434157959434543, 0.9417639827904118, 0.9374231714812539, 0.9443761524277812, 0.9359250153657037, 0.9426475107559926, 0.9396511985248924, 0.9354256299938537], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 0, 'optimizer': 'ExternalDistributedShampoo', 'seed': 43, 'trials': 20, 'log_file': 'comparison_results/run_ExternalDistributedShampoo_43_1756346547594.log', 'success': True}
  ✓ Success - Loss: 0.9478718500307314
Run 3/3
running ExternalDistributedShampoo
Running: python -m benchmark.SVHN --opt ExternalDistributedShampoo --steps 0 --trials 20 --runtime-limit 744 --step-hint 27000
{'runtime': 15128.779560804367, 'attempts': 1, 'best_loss': 0.9492547633681623, 'loss_trajectory': [2.314018726348877, 0.5871410965919495, 0.2593453526496887, 0.24911168217658997, 0.2737143337726593, 0.1489182859659195, 0.2730450928211212, 0.13748542964458466, 0.20362713932991028, 0.1626892238855362, 0.18300826847553253, 0.07761666923761368, 0.26333165168762207, 0.14702259004116058, 0.20751310884952545, 0.09255648404359818, 0.23539282381534576, 0.24851256608963013, 0.2970973253250122, 0.1864299476146698, 0.13048230111598969, 0.3766506612300873, 0.06702850759029388, 0.20573407411575317, 0.1545870155096054, 0.042685844004154205, 0.05734536051750183, 0.11411517858505249], 'test_accuracies': [0.15938076213890595, 0.8635909649661955, 0.9207513829133375, 0.9308927473878303, 0.9344652735095267, 0.9447602950215119, 0.9480639213275968, 0.9492547633681623, 0.9441840811309158, 0.9442609096496619, 0.9412261831591887, 0.942801167793485, 0.9448371235402582, 0.9439920098340504, 0.9434926244622004, 0.9438767670559312, 0.9436462814996927, 0.943300553165335, 0.9395359557467732, 0.9436462814996927, 0.947180393362016, 0.9417255685310387, 0.9400737553779963, 0.9381914566687154, 0.9429164105716041, 0.9448755377996312, 0.9479102642901045, 0.9368085433312846], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 0, 'optimizer': 'ExternalDistributedShampoo', 'seed': 44, 'trials': 20, 'log_file': 'comparison_results/run_ExternalDistributedShampoo_44_1756361625560.log', 'success': True}
  ✓ Success - Loss: 0.9492547633681623

=== Aggregating Results ===

Results saved to: comparison_results
Plots: comparison_results/SVHN_*.png
