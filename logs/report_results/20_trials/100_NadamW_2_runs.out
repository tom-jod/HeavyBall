/var/spool/slurmd/job21701/slurm_script: line 15: cd: HeavyBall: No such file or directory
Current directory /home/tomjodrell/HeavyBall
CUDA_VISIBLE_DEVICES 1
/home/tomjodrell/HeavyBall/benchmark/benchmark_runner.py:289: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
  plt.legend()
Running comparison for CIFAR100
Optimizers: NAdamW
Runs per optimizer: 2
Steps per run: 78000
Optuna trials per run: 20

=== Running NAdamW ===
Run 1/2
running NAdamW
Running: python -m benchmark.CIFAR100 --opt NAdamW --steps 78000 --trials 20 --runtime-limit 992500 --step-hint 78000
{'runtime': 64064.11551237106, 'attempts': 1, 'best_loss': 0.7323, 'loss_trajectory': [4.700896263122559, 2.9993722438812256, 2.3043556213378906, 1.7758777141571045, 1.4350694417953491, 1.3303889036178589, 1.1470268964767456, 0.779535710811615, 0.7857754826545715, 0.6549665331840515, 0.6179371476173401, 0.5780078768730164, 0.6238341927528381, 0.3468477725982666, 0.5088694095611572, 0.4116569757461548, 0.18518896400928497, 0.24624495208263397, 0.3367820680141449, 0.23329806327819824, 0.17607015371322632, 0.19259794056415558, 0.14542342722415924, 0.18883877992630005, 0.10559356957674026, 0.22107987105846405, 0.1269741803407669, 0.21973930299282074, 0.21214500069618225, 0.1186813935637474, 0.1432873010635376, 0.19759917259216309, 0.13501980900764465, 0.11230010539293289, 0.15945032238960266, 0.06804236024618149, 0.08674734830856323, 0.07610812038183212, 0.05649619922041893, 0.04480462893843651, 0.09324250370264053, 0.038219306617975235, 0.04436555877327919, 0.07773497700691223, 0.02896304987370968, 0.06997329741716385, 0.07960066944360733, 0.04067004472017288, 0.032084252685308456, 0.04105820879340172, 0.04577929154038429, 0.036280594766139984, 0.05105867236852646, 0.02348378673195839, 0.023785317316651344, 0.07922187447547913, 0.013349410146474838, 0.04723508283495903, 0.02596600353717804, 0.06215202435851097, 0.03251725062727928, 0.04076169803738594, 0.01622539944946766, 0.044391874223947525, 0.01641356758773327, 0.012758761644363403, 0.007569545414298773, 0.025449570268392563, 0.014290126971900463, 0.05556748807430267, 0.01583508774638176, 0.01637154445052147, 0.02812049351632595, 0.003266001120209694, 0.026717673987150192, 0.01759258657693863, 0.025109324604272842, 0.047689396888017654], 'test_accuracies': [0.0084, 0.2921, 0.4215, 0.4914, 0.5482, 0.5858, 0.6344, 0.6415, 0.663, 0.6738, 0.6737, 0.682, 0.6752, 0.6884, 0.6894, 0.6877, 0.6872, 0.6865, 0.6916, 0.6909, 0.6967, 0.6907, 0.6961, 0.6988, 0.6927, 0.6995, 0.7003, 0.6982, 0.6971, 0.6993, 0.6995, 0.696, 0.6937, 0.7065, 0.6985, 0.7046, 0.7025, 0.7053, 0.7071, 0.7077, 0.7095, 0.7137, 0.7109, 0.7121, 0.7079, 0.7137, 0.7103, 0.7185, 0.7151, 0.7155, 0.7159, 0.716, 0.7177, 0.7201, 0.7149, 0.7177, 0.7215, 0.7272, 0.7217, 0.7234, 0.7239, 0.7249, 0.7237, 0.7268, 0.727, 0.7281, 0.7259, 0.7271, 0.728, 0.7315, 0.7285, 0.73, 0.7297, 0.7299, 0.7302, 0.7305, 0.7323, 0.7322], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 78000, 'optimizer': 'NAdamW', 'seed': 42, 'trials': 20, 'log_file': 'comparison_results/run_NAdamW_42_1757402410850.log', 'success': True}
  ✓ Success - Loss: 0.7323
Run 2/2
running NAdamW
Running: python -m benchmark.CIFAR100 --opt NAdamW --steps 78000 --trials 20 --runtime-limit 992500 --step-hint 78000
{'runtime': 50499.632860183716, 'attempts': 1, 'best_loss': 0.7341, 'loss_trajectory': [4.794627666473389, 3.024096727371216, 2.2344820499420166, 1.7342748641967773, 1.4831026792526245, 1.2626550197601318, 1.069693684577942, 0.8050721883773804, 0.7677208781242371, 0.6434227824211121, 0.5958790183067322, 0.569390058517456, 0.5567825436592102, 0.2586979866027832, 0.5845616459846497, 0.3648713231086731, 0.283751517534256, 0.2773200571537018, 0.19397388398647308, 0.2653021216392517, 0.15969637036323547, 0.21355587244033813, 0.1436682641506195, 0.1591862291097641, 0.12443829327821732, 0.2524002194404602, 0.15626274049282074, 0.2541108727455139, 0.1221206784248352, 0.14098800718784332, 0.14184272289276123, 0.34039223194122314, 0.17173552513122559, 0.10254046320915222, 0.15744271874427795, 0.07422732561826706, 0.15500345826148987, 0.15681318938732147, 0.033550623804330826, 0.055647674947977066, 0.12115900218486786, 0.07631782442331314, 0.05539803206920624, 0.09211521595716476, 0.023816367611289024, 0.030639514327049255, 0.11504281312227249, 0.09874013811349869, 0.008344147354364395, 0.07247263193130493, 0.07258472591638565, 0.02490289881825447, 0.025988446548581123, 0.02334183268249035, 0.019341066479682922, 0.02647903561592102, 0.04588143900036812, 0.06820958107709885, 0.006718811579048634, 0.05471757426857948, 0.008807587437331676, 0.010629644617438316, 0.04227675125002861, 0.01742762140929699, 0.043196167796850204, 0.08117611706256866, 0.030662883073091507, 0.041303303092718124, 0.028531387448310852, 0.09808765351772308, 0.020295944064855576, 0.0069389184936881065, 0.008368107490241528, 0.013420495204627514, 0.01488160714507103, 0.045341432094573975, 0.017279280349612236, 0.04872593283653259], 'test_accuracies': [0.0133, 0.2841, 0.4323, 0.5009, 0.5478, 0.6002, 0.6326, 0.6496, 0.6677, 0.6729, 0.6694, 0.6826, 0.6751, 0.6876, 0.6823, 0.6805, 0.6953, 0.698, 0.6881, 0.6899, 0.6898, 0.6878, 0.6959, 0.6896, 0.6946, 0.7006, 0.6988, 0.7027, 0.6978, 0.6966, 0.7074, 0.7027, 0.7044, 0.7031, 0.701, 0.7047, 0.7044, 0.7024, 0.7025, 0.7057, 0.7105, 0.7103, 0.7128, 0.7126, 0.712, 0.7084, 0.7121, 0.7125, 0.7129, 0.7127, 0.7133, 0.7159, 0.7172, 0.7176, 0.7183, 0.7209, 0.7188, 0.721, 0.7229, 0.7247, 0.7248, 0.7246, 0.7264, 0.7298, 0.7293, 0.7291, 0.731, 0.7305, 0.7312, 0.7305, 0.7338, 0.7301, 0.7321, 0.7326, 0.7327, 0.7341, 0.734, 0.7336], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 78000, 'optimizer': 'NAdamW', 'seed': 43, 'trials': 20, 'log_file': 'comparison_results/run_NAdamW_43_1757466481479.log', 'success': True}
  ✓ Success - Loss: 0.7341

=== Aggregating Results ===

Results saved to: comparison_results
Plots: comparison_results/CIFAR100_*.png
