/var/spool/slurmd/job21750/slurm_script: line 15: cd: HeavyBall: No such file or directory
Current directory /home/tomjodrell/HeavyBall
CUDA_VISIBLE_DEVICES 1
Running comparison for SVHN
Optimizers: ExternalDistributedShampoo
Runs per optimizer: 3
Steps per run: 86000
Optuna trials per run: 20

=== Running ExternalDistributedShampoo ===
Run 1/3
running ExternalDistributedShampoo
Running: python -m benchmark.SVHN --opt ExternalDistributedShampoo --steps 86000 --trials 20 --runtime-limit 992500 --step-hint 86000
{'runtime': 77841.55622887611, 'attempts': 1, 'best_loss': 0.9428779963122311, 'loss_trajectory': [2.31575870513916, 0.851148247718811, 0.285165399312973, 0.14555519819259644, 0.16637730598449707, 0.15497900545597076, 0.21535538136959076, 0.17878510057926178, 0.1980321705341339, 0.02589247189462185, 0.043166808784008026, 0.0752410814166069, 0.20746243000030518, 0.059258490800857544, 0.2470851093530655, 0.21798276901245117, 0.05036625638604164, 0.0626334697008133, 0.12871898710727692, 0.06946327537298203, 0.08066455274820328, 0.28437313437461853, 0.045354705303907394, 0.1790199875831604, 0.03873688727617264, 0.055354438722133636, 0.06754688173532486, 0.013985730707645416, 0.05440383777022362, 0.11194400489330292, 0.17609642446041107, 0.04362061247229576, 0.14471998810768127, 0.020868558436632156, 0.1705317348241806, 0.29168230295181274, 0.01210646703839302, 0.13642378151416779, 0.056498315185308456, 0.10202255100011826, 0.0527198426425457, 0.07865739613771439, 0.021821513772010803, 0.025905843824148178, 0.047019701451063156, 0.18325959146022797, 0.08521177619695663, 0.05151548981666565, 0.04858265444636345, 0.0864633172750473, 0.029035693034529686, 0.021365003660321236, 0.07470668107271194, 0.054536059498786926, 0.009111638180911541, 0.0770476683974266, 0.10325399786233902, 0.06135331466794014, 0.05990354344248772, 0.0754527896642685, 0.14774596691131592, 0.04950324073433876, 0.026101557537913322, 0.030929293483495712, 0.0241555105894804, 0.03750351071357727, 0.03571547195315361, 0.04911419376730919, 0.03425181657075882, 0.07382368296384811, 0.009915298782289028, 0.022598542273044586, 0.05179549381136894, 0.09722869098186493, 0.10350167751312256, 0.06350354105234146, 0.031401317566633224, 0.04454208165407181, 0.17515762150287628, 0.15654093027114868, 0.005155971273779869, 0.07241026312112808, 0.056230220943689346, 0.09506460279226303, 0.07640526443719864, 0.1505441963672638], 'test_accuracies': [0.06699446834665028, 0.8433850645359557, 0.9056161647203442, 0.9292409342347879, 0.9358097725875845, 0.9330823601720959, 0.938460356484327, 0.9367701290719115, 0.9332360172095882, 0.9397280270436386, 0.9383451137062078, 0.9411877688998156, 0.9353872157344807, 0.9337738168408113, 0.9368469575906576, 0.9318531038721574, 0.9335049170251998, 0.9319683466502766, 0.9329671173939766, 0.9380377996312231, 0.933159188690842, 0.936539643515673, 0.9351567301782422, 0.9292409342347879, 0.9301244622003688, 0.9336969883220652, 0.934119545175169, 0.9352335586969883, 0.9340427166564229, 0.9328902888752305, 0.9242854947756607, 0.9324677320221266, 0.9300092194222496, 0.9324293177627535, 0.9347725875845113, 0.928779963122311, 0.932659803318992, 0.941840811309158, 0.9351183159188691, 0.9264751075599262, 0.9368853718500307, 0.9399585125998771, 0.9159496004917025, 0.9326982175783651, 0.9261293792255685, 0.9334665027658267, 0.9328134603564844, 0.9336969883220652, 0.9375384142593731, 0.9289720344191764, 0.9397280270436386, 0.9323524892440074, 0.9390365703749232, 0.932160417947142, 0.9345805162876459, 0.9230562384757222, 0.9349646588813768, 0.928318992009834, 0.9337354025814383, 0.9298171481253842, 0.9310464044253227, 0.926359864781807, 0.9308927473878303, 0.9379225568531039, 0.9343116164720344, 0.9326213890596189, 0.9368085433312846, 0.928779963122311, 0.9353872157344807, 0.9323140749846343, 0.9353103872157345, 0.9304701905347265, 0.9324293177627535, 0.9366933005531654, 0.9217501536570375, 0.9331976029502151, 0.9304701905347265, 0.9428779963122311, 0.9314305470190535, 0.9322756607252612, 0.9358097725875845, 0.9257836508912108, 0.9325445605408728, 0.9252458512599877, 0.928280577750461, 0.9284342347879533], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 86000, 'optimizer': 'ExternalDistributedShampoo', 'seed': 42, 'trials': 20, 'log_file': 'comparison_results/run_ExternalDistributedShampoo_42_1757447481863.log', 'success': True}
  ✓ Success - Loss: 0.9428779963122311
Run 2/3
running ExternalDistributedShampoo
Running: python -m benchmark.SVHN --opt ExternalDistributedShampoo --steps 86000 --trials 20 --runtime-limit 992500 --step-hint 86000
{'runtime': 65851.19169473648, 'attempts': 1, 'best_loss': 0.942839582052858, 'loss_trajectory': [2.31421160697937, 0.8701340556144714, 0.3584893047809601, 0.17008836567401886, 0.16980479657649994, 0.16379360854625702, 0.23221096396446228, 0.18842816352844238, 0.09060174971818924, 0.08922354876995087, 0.041077811270952225, 0.06897520273923874, 0.18352864682674408, 0.052447300404310226, 0.19770269095897675, 0.12657280266284943, 0.05310485512018204, 0.040935419499874115, 0.020678676664829254, 0.150422602891922, 0.054429952055215836, 0.26373857259750366, 0.02013852261006832, 0.18058978021144867, 0.016046306118369102, 0.1474204659461975, 0.04043092578649521, 0.09889094531536102, 0.06599196791648865, 0.06924116611480713, 0.16409413516521454, 0.0051031275652348995, 0.1347285807132721, 0.061261311173439026, 0.0959722101688385, 0.27608776092529297, 0.018905317410826683, 0.03738385811448097, 0.03200635686516762, 0.0889894962310791, 0.033985622227191925, 0.042797334492206573, 0.022313520312309265, 0.03796945512294769, 0.036311905831098557, 0.1744910627603531, 0.03311982378363609, 0.07177042216062546, 0.057250235229730606, 0.10695052891969681, 0.04043523594737053, 0.037312135100364685, 0.03869478031992912, 0.049996934831142426, 0.0059584397822618484, 0.03365996479988098, 0.043727293610572815, 0.06361235678195953, 0.0900072231888771, 0.04826345294713974, 0.18780417740345, 0.08246071636676788, 0.03911147639155388, 0.05963588505983353, 0.026618991047143936, 0.035295043140649796, 0.01922493986785412, 0.1033950001001358, 0.03605836629867554, 0.03583954647183418, 0.01759856939315796, 0.04364452511072159, 0.03491848707199097, 0.02646419033408165, 0.061182960867881775, 0.032104119658470154, 0.03588438406586647, 0.01702854223549366, 0.11064565181732178, 0.09613022953271866, 0.004202933982014656, 0.04206234589219093, 0.04011363908648491, 0.045128513127565384, 0.07131586223840714, 0.1343674212694168], 'test_accuracies': [0.1107098955132145, 0.8093884449907806, 0.9141825445605408, 0.9233635525507068, 0.9306622618315918, 0.9319683466502766, 0.9382298709280885, 0.9278580208973571, 0.9318531038721574, 0.9330823601720959, 0.9361939151813153, 0.93899815611555, 0.9243239090350338, 0.9312384757221881, 0.9266671788567916, 0.9337354025814383, 0.9239013521819299, 0.9211355255070682, 0.917178856791641, 0.9294330055316533, 0.9340043023970498, 0.9366164720344192, 0.9330055316533498, 0.9217885679164106, 0.9295866625691457, 0.9339274738783037, 0.9258220651505839, 0.9357329440688383, 0.9242854947756607, 0.9323524892440074, 0.9240550092194223, 0.9356945298094653, 0.9247464658881377, 0.9314689612784266, 0.9269744929317763, 0.9314689612784266, 0.922019053472649, 0.9318915181315304, 0.9348878303626306, 0.9305854333128457, 0.9345421020282729, 0.9275891210817455, 0.9262830362630609, 0.9335433312845728, 0.9337354025814383, 0.933120774431469, 0.9325061462814997, 0.9298171481253842, 0.9397664413030117, 0.9301244622003688, 0.930700676090965, 0.9356177012907191, 0.9315457897971727, 0.9325061462814997, 0.9246312231100184, 0.9312768899815611, 0.9398432698217578, 0.9358481868469576, 0.927358635525507, 0.9305470190534727, 0.9261293792255685, 0.9403042409342348, 0.9304317762753535, 0.9278964351567301, 0.9307390903503381, 0.9344268592501537, 0.9332744314689613, 0.9311232329440688, 0.9402274124154887, 0.9358097725875845, 0.928779963122311, 0.9368085433312846, 0.9348110018438844, 0.942839582052858, 0.9277043638598648, 0.9261293792255685, 0.9391902274124155, 0.9281653349723418, 0.9246312231100184, 0.9299323909035033, 0.9375384142593731, 0.9335433312845728, 0.9354256299938537, 0.9350030731407498, 0.928779963122311, 0.9259757221880762], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 86000, 'optimizer': 'ExternalDistributedShampoo', 'seed': 43, 'trials': 20, 'log_file': 'comparison_results/run_ExternalDistributedShampoo_43_1757525333338.log', 'success': True}/home/tomjodrell/HeavyBall/benchmark/benchmark_runner.py:289: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
  plt.legend()

  ✓ Success - Loss: 0.942839582052858
Run 3/3
running ExternalDistributedShampoo
Running: python -m benchmark.SVHN --opt ExternalDistributedShampoo --steps 86000 --trials 20 --runtime-limit 992500 --step-hint 86000
{'runtime': 78965.58956718445, 'attempts': 1, 'best_loss': 0.9430700676090965, 'loss_trajectory': [2.2983837127685547, 0.8844763040542603, 0.34000495076179504, 0.21491633355617523, 0.2705938518047333, 0.17821040749549866, 0.28689152002334595, 0.2850574553012848, 0.2252274453639984, 0.24926108121871948, 0.1784670650959015, 0.2571720480918884, 0.03417070209980011, 0.22410376369953156, 0.2311178594827652, 0.12784847617149353, 0.08875992894172668, 0.04193625971674919, 0.12084604799747467, 0.06893705576658249, 0.1152302548289299, 0.23420150578022003, 0.11297660320997238, 0.1715797781944275, 0.18570855259895325, 0.013029406778514385, 0.06175410374999046, 0.030920032411813736, 0.031070778146386147, 0.027145441621541977, 0.12984570860862732, 0.08031591027975082, 0.22799213230609894, 0.02291124314069748, 0.02125229872763157, 0.006675519980490208, 0.19484636187553406, 0.03316408768296242, 0.04263831675052643, 0.12330619990825653, 0.06803258508443832, 0.07352685183286667, 0.029065633192658424, 0.05154182016849518, 0.02950930967926979, 0.01527516357600689, 0.07367910444736481, 0.11098974198102951, 0.07250627875328064, 0.07451840490102768, 0.028147689998149872, 0.030911115929484367, 0.017219584435224533, 0.08884136378765106, 0.02825305052101612, 0.026433000341057777, 0.008150753565132618, 0.032953400164842606, 0.030376648530364037, 0.051432814449071884, 0.01954270526766777, 0.005619004834443331, 0.03915407136082649, 0.04297969490289688, 0.03203359618782997, 0.03730813413858414, 0.0864749625325203, 0.02247404120862484, 0.06046195328235626, 0.09852445870637894, 0.033512622117996216, 0.044600073248147964, 0.10522673279047012, 0.025917772203683853, 0.025605779141187668, 0.12016749382019043, 0.0676339864730835, 0.12968140840530396, 0.05843836069107056, 0.06981204450130463, 0.07563643902540207, 0.022517656907439232, 0.04262955114245415, 0.06841084361076355, 0.022500623017549515, 0.0745651051402092], 'test_accuracies': [0.09157959434542103, 0.7759680393362016, 0.9032728948985863, 0.9277811923786109, 0.9353488014751076, 0.9363859864781807, 0.93799938537185, 0.9299323909035033, 0.9361555009219422, 0.9325061462814997, 0.9289720344191764, 0.9384219422249539, 0.9386140135218193, 0.9250537799631223, 0.9342732022126613, 0.9371542716656422, 0.9267824216349109, 0.923978180700676, 0.9315457897971727, 0.9325829748002459, 0.9311232329440688, 0.9266287645974186, 0.9353488014751076, 0.9262446220036877, 0.9267055931161647, 0.9333512599877074, 0.9343884449907806, 0.9362707437000615, 0.9346189305470191, 0.9333128457283344, 0.92490012292563, 0.9403810694529809, 0.9370774431468961, 0.9302397049784881, 0.9346957590657652, 0.9316226183159189, 0.942839582052858, 0.932659803318992, 0.9300860479409957, 0.9282037492317148, 0.9391133988936693, 0.9298939766441303, 0.9335049170251998, 0.9309695759065765, 0.9353103872157345, 0.9192532267977873, 0.9305470190534727, 0.9260141364474493, 0.9319683466502766, 0.9350414874001229, 0.933159188690842, 0.9356177012907191, 0.9286263060848187, 0.9303165334972342, 0.9430700676090965, 0.9312768899815611, 0.9379225568531039, 0.9345421020282729, 0.9277811923786109, 0.9332744314689613, 0.9391902274124155, 0.9378841425937308, 0.9342347879532883, 0.9306238475722188, 0.9346189305470191, 0.9277427781192379, 0.9357713583282115, 0.931699446834665, 0.9262062077443147, 0.9355024585125998, 0.932160417947142, 0.9306238475722188, 0.9366933005531654, 0.9284726490473264, 0.9333512599877074, 0.9339274738783037, 0.9339658881376767, 0.9346573448063922, 0.9340811309157959, 0.9399200983405039, 0.9293561770129072, 0.9398048555623848, 0.9275122925629994, 0.9303933620159803, 0.9369622003687769, 0.9310079901659496], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 86000, 'optimizer': 'ExternalDistributedShampoo', 'seed': 44, 'trials': 20, 'log_file': 'comparison_results/run_ExternalDistributedShampoo_44_1757591228863.log', 'success': True}
  ✓ Success - Loss: 0.9430700676090965

=== Aggregating Results ===

Results saved to: comparison_results
Plots: comparison_results/SVHN_*.png
