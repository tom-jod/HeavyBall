/var/spool/slurmd/job20837/slurm_script: line 15: cd: HeavyBall: No such file or directory
Current directory /home/tomjodrell/HeavyBall
CUDA_VISIBLE_DEVICES 0
/home/tomjodrell/HeavyBall/benchmark/benchmark_runner.py:289: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
  plt.legend()
Running comparison for CIFAR100
Optimizers: AdamW, NAdamW, SFAdamW
Runs per optimizer: 1
Steps per run: 78000
Optuna trials per run: 5

=== Running AdamW ===
Run 1/1
running AdamW
Running: python -m benchmark.CIFAR100 --opt AdamW --steps 78000 --trials 5 --runtime-limit 7200 --step-hint 78000
{'runtime': 34545.06437754631, 'attempts': 1, 'best_loss': 0.7732, 'loss_trajectory': [4.710638999938965, 3.1406142711639404, 2.6551263332366943, 2.2514688968658447, 1.8990633487701416, 2.0463547706604004, 1.995262861251831, 1.8289735317230225, 1.8943382501602173, 1.7141159772872925, 1.6286497116088867, 1.532926321029663, 1.8364700078964233, 1.8215985298156738, 1.7475582361221313, 1.5720411539077759, 1.620467185974121, 1.6533294916152954, 1.3734689950942993, 1.3702589273452759, 1.5150408744812012, 1.630026936531067, 1.611568808555603, 1.7942142486572266, 1.2974655628204346, 1.187944769859314, 1.3816951513290405, 1.192319631576538, 1.3151626586914062, 1.3981770277023315, 1.2868002653121948, 1.4128162860870361, 1.1989067792892456, 1.393120288848877, 1.2889879941940308, 1.2361623048782349, 1.0690975189208984, 1.1571972370147705, 0.9871122241020203, 1.2158548831939697, 0.9160928726196289, 0.9032907485961914, 1.0337740182876587, 1.1292238235473633, 0.7993812561035156, 0.9460735321044922, 0.9268074631690979, 0.7523271441459656, 1.0254504680633545, 0.8029228448867798, 0.9269452095031738, 0.7840865850448608, 0.6755532622337341, 0.9294707775115967, 0.7750983834266663, 0.6316235065460205, 0.5553865432739258, 0.6787396669387817, 0.3575168251991272, 0.5020593404769897, 0.5642465353012085, 0.5849572420120239, 0.3907087445259094, 0.4112710952758789, 0.3859865367412567, 0.32912126183509827, 0.2681417465209961, 0.271902859210968, 0.38363397121429443, 0.29236289858818054, 0.2525402009487152, 0.229230135679245, 0.2394259124994278, 0.20947110652923584, 0.1887095421552658, 0.22818037867546082, 0.20688433945178986, 0.20671924948692322], 'test_accuracies': [0.01, 0.2041, 0.307, 0.3515, 0.4223, 0.3935, 0.5009, 0.4538, 0.5132, 0.5408, 0.539, 0.5163, 0.5194, 0.5193, 0.5045, 0.5417, 0.5579, 0.5533, 0.5632, 0.5807, 0.5771, 0.5347, 0.554, 0.6058, 0.5767, 0.5557, 0.5717, 0.5846, 0.5943, 0.6085, 0.5732, 0.5642, 0.6349, 0.6062, 0.625, 0.6023, 0.6159, 0.6313, 0.6262, 0.6005, 0.6193, 0.6605, 0.6107, 0.6482, 0.6715, 0.6539, 0.6779, 0.6814, 0.6809, 0.6766, 0.6749, 0.6981, 0.6942, 0.6927, 0.7066, 0.7167, 0.7151, 0.7215, 0.7247, 0.7297, 0.7287, 0.7422, 0.7369, 0.7419, 0.7479, 0.7518, 0.7551, 0.7579, 0.7594, 0.7618, 0.7612, 0.7638, 0.7683, 0.771, 0.7732, 0.7713, 0.7731, 0.7703], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 78000, 'optimizer': 'AdamW', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_AdamW_42_1755703615798.log', 'success': True}
  ✓ Success - Loss: 0.7732

=== Running NAdamW ===
Run 1/1
running NAdamW
Running: python -m benchmark.CIFAR100 --opt NAdamW --steps 78000 --trials 5 --runtime-limit 7200 --step-hint 78000
{'runtime': None, 'attempts': None, 'best_loss': None, 'loss_trajectory': [], 'test_accuracies': [], 'grad_variances': [], 'config_str': '', 'mean_cond': None, 'std_err_cond': None, 'memory_usage': None, 'steps': 78000, 'optimizer': 'NAdamW', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_NAdamW_42_1755738166771.log', 'success': False}
  ✗ Failed - Unknown error

=== Running SFAdamW ===
Run 1/1
running SFAdamW
Running: python -m benchmark.CIFAR100 --opt SFAdamW --steps 78000 --trials 5 --runtime-limit 7200 --step-hint 78000
{'runtime': 23926.011061668396, 'attempts': 1, 'best_loss': 0.6964, 'loss_trajectory': [4.731229305267334, 2.917401075363159, 2.3726983070373535, 1.8757716417312622, 1.4095029830932617, 0.977872908115387, 1.0504002571105957, 0.9668675661087036, 0.8566164970397949, 0.7396244406700134, 0.5513766407966614, 0.47479718923568726, 0.5346056222915649, 0.4463711380958557, 0.40400266647338867, 0.4167672395706177, 0.32919466495513916, 0.2667310833930969, 0.30675920844078064, 0.168613001704216, 0.22407954931259155, 0.24471285939216614, 0.2101808339357376, 0.1828264743089676, 0.23406630754470825, 0.12802764773368835, 0.1875605285167694, 0.2004120647907257, 0.19184203445911407, 0.09401117265224457, 0.0934300571680069, 0.1239694356918335, 0.10996808111667633, 0.08962789922952652, 0.1531423032283783, 0.09154854714870453, 0.18689167499542236, 0.16259640455245972, 0.10632453113794327, 0.13048750162124634, 0.16601906716823578, 0.10855766385793686, 0.058144114911556244, 0.16511288285255432, 0.14191465079784393, 0.16085472702980042, 0.016323205083608627, 0.07642504572868347, 0.03662845492362976, 0.11482130736112595, 0.06770921498537064, 0.1191725805401802, 0.058535002171993256, 0.11683782190084457, 0.13326865434646606, 0.07781422883272171, 0.1294109970331192, 0.0918056070804596, 0.09985152631998062, 0.11503404378890991, 0.1396798938512802, 0.04764854535460472, 0.015428662300109863, 0.092966727912426, 0.04889422282576561, 0.12798799574375153, 0.06997181475162506, 0.1750125139951706, 0.12702856957912445, 0.0657041072845459, 0.10545274615287781, 0.07542017102241516, 0.14837467670440674, 0.02618258446455002, 0.0905962884426117, 0.10389673709869385, 0.05844812095165253, 0.1152668297290802], 'test_accuracies': [0.0093, 0.2846, 0.4422, 0.5207, 0.5659, 0.6006, 0.6315, 0.6452, 0.6557, 0.6676, 0.6707, 0.6745, 0.6731, 0.6766, 0.6811, 0.6804, 0.6865, 0.6874, 0.6864, 0.6844, 0.6851, 0.6918, 0.6873, 0.6875, 0.6893, 0.6894, 0.6884, 0.6885, 0.6932, 0.6901, 0.6907, 0.6907, 0.6846, 0.6896, 0.6855, 0.6843, 0.6915, 0.6939, 0.689, 0.693, 0.6892, 0.6875, 0.6865, 0.6865, 0.6859, 0.6882, 0.6923, 0.6908, 0.6898, 0.6882, 0.693, 0.6945, 0.6942, 0.6962, 0.6939, 0.6927, 0.6945, 0.6897, 0.6869, 0.6852, 0.6869, 0.6892, 0.6933, 0.6923, 0.6921, 0.6962, 0.696, 0.6931, 0.6913, 0.689, 0.6914, 0.6903, 0.6888, 0.6928, 0.6925, 0.6947, 0.6964, 0.6937], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 78000, 'optimizer': 'SFAdamW', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_SFAdamW_42_1755752521873.log', 'success': True}
  ✓ Success - Loss: 0.6964

=== Aggregating Results ===

Results saved to: comparison_results
Plots: comparison_results/CIFAR100_*.png
