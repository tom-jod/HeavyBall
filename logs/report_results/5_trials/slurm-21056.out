/var/spool/slurmd/job21056/slurm_script: line 15: cd: HeavyBall: No such file or directory
Current directory /home/tomjodrell/HeavyBall
CUDA_VISIBLE_DEVICES 3
Running comparison for CIFAR10_wide
Optimizers: ExternalDistributedShampoo
Runs per optimizer: 1
Steps per run: 78000
Optuna trials per run: 5

=== Running ExternalDistributedShampoo ===
Run 1/1
running ExternalDistributedShampoo
Running: python -m benchmark.CIFAR10_wide --opt ExternalDistributedShampoo --steps 78000 --trials 5 --runtime-limit 227200 --step-hint 78000
{'runtime': 71488.45009088516, 'attempts': 1, 'best_loss': 0.9406, 'loss_trajectory': [2.351114273071289, 0.6633965969085693, 0.40806543827056885, 0.2591664791107178, 0.24508562684059143, 0.2657172381877899, 0.20374499261379242, 0.14693090319633484, 0.3323264420032501, 0.1749425083398819, 0.15989576280117035, 0.17855532467365265, 0.08424433320760727, 0.11445947736501694, 0.13878369331359863, 0.10548321902751923, 0.17063386738300323, 0.13183459639549255, 0.06923945993185043, 0.01172962598502636, 0.054688967764377594, 0.07718002051115036, 0.04518600180745125, 0.08280070871114731, 0.05654868856072426, 0.06278235465288162, 0.0504281185567379, 0.04228740930557251, 0.04241873696446419, 0.07861983776092529, 0.046852998435497284, 0.03331049159169197, 0.04131337255239487, 0.04115636646747589, 0.13584503531455994, 0.10451553016901016, 0.06118768826127052, 0.012798646464943886, 0.04994625225663185, 0.13447630405426025, 0.05911875143647194, 0.014653096906840801, 0.020963555201888084, 0.01953091099858284, 0.03331334888935089, 0.030469369143247604, 0.016985947266221046, 0.014460821636021137, 0.0600150004029274, 0.027993571013212204, 0.05623014271259308, 0.026831425726413727, 0.024640752002596855, 0.024306200444698334, 0.03774324432015419, 0.027781613171100616, 0.016261450946331024, 0.03398650139570236, 0.03961572051048279, 0.025314226746559143, 0.057521503418684006, 0.0872514620423317, 0.011487987823784351, 0.07404554635286331, 0.08339201658964157, 0.04042820632457733, 0.012747726403176785, 0.008349889889359474, 0.011299505829811096, 0.02300878055393696, 0.029437316581606865, 0.08051852136850357, 0.020941929891705513, 0.006832271348685026, 0.035980332642793655, 0.027283990755677223, 0.010581991635262966, 0.01301859226077795], 'test_accuracies': [0.1341, 0.7239, 0.8461, 0.864, 0.8845, 0.8986, 0.9011, 0.9129, 0.9097, 0.9214, 0.9196, 0.9182, 0.9283, 0.924, 0.9272, 0.9254, 0.9325, 0.9279, 0.9264, 0.9322, 0.9288, 0.9266, 0.9288, 0.9313, 0.9314, 0.9339, 0.9323, 0.9314, 0.9371, 0.9328, 0.9301, 0.934, 0.9332, 0.9326, 0.9315, 0.9323, 0.9335, 0.9323, 0.937, 0.9343, 0.9314, 0.935, 0.9331, 0.934, 0.9393, 0.9384, 0.9357, 0.9406, 0.9346, 0.9356, 0.9388, 0.9378, 0.9321, 0.9378, 0.9392, 0.9335, 0.9384, 0.9356, 0.9342, 0.938, 0.9372, 0.9352, 0.9386, 0.9378, 0.9358, 0.9394, 0.9391, 0.9364, 0.9402, 0.9355, 0.9362, 0.9386, 0.9372, 0.9389, 0.9396, 0.9382, 0.9392, 0.9402], 'grad_variances': [3.1207463280225056e-07, 1.191737396766257e-06, 6.841900699328107e-07, 4.583387465117994e-07, 3.258037963860261e-07, 2.3913571567391045e-07, 1.9914746474114509e-07, 1.619618359427477e-07, 1.309031461005361e-07, 1.2193640941404738e-07, 9.802020173310666e-08, 1.0720767562588662e-07, 7.694310255601522e-08, 8.874889090293436e-08, 7.555636472034166e-08, 6.320376400026362e-08, 5.7994181901221964e-08, 5.336799446808982e-08, 6.424681231465001e-08, 5.7264383457322765e-08, 5.337228969892749e-08, 5.6954963412181314e-08, 6.144272646224636e-08, 4.3917072645172084e-08, 5.1328306938103196e-08, 3.9534448603717465e-08, 4.371388229174045e-08, 4.369047701402451e-08, 3.7323228951890997e-08, 4.4267661536423475e-08, 3.7554169551867744e-08, 3.4287005235000834e-08, 3.292030115176203e-08, 3.942857773608921e-08, 3.933143233325609e-08, 3.4658739878068445e-08, 4.165161016089769e-08, 3.163144057793943e-08, 3.4375915447526495e-08, 3.101123269289019e-08, 2.784364561136954e-08, 2.9347702934501285e-08, 2.9889715591480126e-08, 3.306662321733711e-08, 2.960725886680393e-08, 2.732760329138273e-08, 2.754724626186089e-08, 2.512870800330802e-08, 2.816295285867909e-08, 2.58310173251175e-08, 2.2994965931388833e-08, 2.3344213673226477e-08, 2.6692536181371906e-08, 2.6076568460098315e-08, 2.035571888825416e-08, 2.5500970224356934e-08, 2.4366222817207017e-08, 2.1411176831520606e-08, 2.5447633333897102e-08, 2.4871274817428457e-08, 2.353649009023684e-08, 2.8161986520558457e-08, 2.253551123487796e-08, 2.3417902283995318e-08, 1.839184982088682e-08, 2.246551744633507e-08, 2.2781057040788255e-08, 2.293440637402e-08, 1.8927368117260812e-08, 2.120410869110856e-08, 2.3037943108761283e-08, 1.9595272959804788e-08, 2.0906373521256683e-08, 1.6782431444539725e-08, 1.9816138063788458e-08, 1.634492896585016e-08, 1.922151682265394e-08, 1.5799930253024286e-08], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 78000, 'optimizer': 'ExternalDistributedShampoo', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_ExternalDistributedShampoo_42_1756210298819.log', 'success': True}
  âœ“ Success - Loss: 0.9406

=== Aggregating Results ===

Results saved to: comparison_results
Plots: comparison_results/CIFAR10_wide_*.png
