/var/spool/slurmd/job21089/slurm_script: line 15: cd: HeavyBall: No such file or directory
Current directory /home/tomjodrell/HeavyBall
CUDA_VISIBLE_DEVICES 0
/home/tomjodrell/HeavyBall/benchmark/benchmark_runner.py:289: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
  plt.legend()
Running comparison for SVHN
Optimizers: NAdamW, SFAdamW
Runs per optimizer: 2
Steps per run: 27000
Optuna trials per run: 20

=== Running NAdamW ===
Run 1/2
running NAdamW
Running: python -m benchmark.SVHN --opt NAdamW --steps 27000 --trials 20 --runtime-limit 227200 --step-hint 27000
{'runtime': 4469.254077672958, 'attempts': 1, 'best_loss': 0.9307390903503381, 'loss_trajectory': [2.331672191619873, 2.1948060989379883, 1.9633615016937256, 1.6336780786514282, 1.3077149391174316, 0.8457891345024109, 1.0203649997711182, 0.5822670459747314, 0.6433155536651611, 0.5691676139831543, 0.15866291522979736, 0.5307835936546326, 0.302002876996994, 0.34026816487312317, 0.251370906829834, 0.48112231492996216, 0.20777422189712524, 0.26535096764564514, 0.14150500297546387, 0.17281150817871094, 0.14770843088626862, 0.21563024818897247, 0.1677074134349823, 0.15091951191425323, 0.2440318763256073, 0.3300579786300659, 0.23097363114356995], 'test_accuracies': [0.07755838967424708, 0.1958743085433313, 0.3078134603564843, 0.403080823601721, 0.5800553165334973, 0.7014443761524278, 0.7465811309157959, 0.8283266748617086, 0.8314766441303012, 0.8768438844499078, 0.881338352796558, 0.9010832821143209, 0.9016979102642901, 0.8688537185003073, 0.9218269821757836, 0.9144898586355255, 0.9154118008604795, 0.9136831591886908, 0.9251690227412416, 0.9234019668100799, 0.9247080516287646, 0.9137984019668101, 0.9210971112476951, 0.9180239704978488, 0.9303933620159803, 0.9307390903503381, 0.9172556853103873], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'NAdamW', 'seed': 42, 'trials': 20, 'log_file': 'comparison_results/run_NAdamW_42_1756247634738.log', 'success': True}
  ✓ Success - Loss: 0.9307390903503381
Run 2/2
running NAdamW
Running: python -m benchmark.SVHN --opt NAdamW --steps 27000 --trials 20 --runtime-limit 227200 --step-hint 27000
{'runtime': 4491.427579641342, 'attempts': 1, 'best_loss': 0.9311232329440688, 'loss_trajectory': [2.280890941619873, 2.1902170181274414, 1.9321262836456299, 1.766394019126892, 1.4812618494033813, 1.0838415622711182, 0.8686198592185974, 0.5416363477706909, 0.47744300961494446, 0.7081384658813477, 0.18516205251216888, 0.565952718257904, 0.2830573618412018, 0.29206064343452454, 0.23736132681369781, 0.4484620690345764, 0.22521546483039856, 0.2556644082069397, 0.14242573082447052, 0.2728753685951233, 0.1713157445192337, 0.21817663311958313, 0.1639436036348343, 0.09626349061727524, 0.28156206011772156, 0.26837366819381714, 0.17675498127937317], 'test_accuracies': [0.1107098955132145, 0.1958743085433313, 0.31845421020282727, 0.35694529809465275, 0.4329287031346036, 0.6501229256299939, 0.7537645974185617, 0.8317455439459127, 0.8658574062692072, 0.8521051014136447, 0.8900968039336201, 0.878380454824831, 0.8992393976644131, 0.9056161647203442, 0.9075368776889982, 0.9181776275353412, 0.927358635525507, 0.9091118623232944, 0.9311232329440688, 0.9018515673017824, 0.9119545175169023, 0.9245543945912723, 0.9168715427166564, 0.9291641057160418, 0.9192916410571604, 0.9262830362630609, 0.9206361401352182], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'NAdamW', 'seed': 43, 'trials': 20, 'log_file': 'comparison_results/run_NAdamW_43_1756252111127.log', 'success': True}
  ✓ Success - Loss: 0.9311232329440688

=== Running SFAdamW ===
Run 1/2
running SFAdamW
Running: python -m benchmark.SVHN --opt SFAdamW --steps 27000 --trials 20 --runtime-limit 227200 --step-hint 27000
{'runtime': 3625.4971866607666, 'attempts': 1, 'best_loss': 0.9420328826060234, 'loss_trajectory': [2.322537422180176, 1.7041068077087402, 0.9045186638832092, 0.8175323605537415, 0.42824676632881165, 0.31947970390319824, 0.24855972826480865, 0.48215559124946594, 0.2693341076374054, 0.2837263345718384, 0.2925185561180115, 0.21463067829608917, 0.19006697833538055, 0.27674639225006104, 0.21657299995422363, 0.13863377273082733, 0.2236672341823578, 0.24052543938159943, 0.13445539772510529, 0.04743169620633125, 0.08391106873750687, 0.2019169181585312, 0.041463032364845276, 0.11121328175067902, 0.06497949361801147, 0.09877272695302963, 0.08973793685436249], 'test_accuracies': [0.15938076213890595, 0.38471880762138905, 0.6765135218192994, 0.7901044867854948, 0.855139827904118, 0.8879840196681008, 0.9057698217578365, 0.9141057160417947, 0.9172172710510141, 0.923440381069453, 0.9278580208973571, 0.9283574062692072, 0.9301244622003688, 0.9226336816226183, 0.9318915181315304, 0.9376152427781193, 0.9346189305470191, 0.9362323294406883, 0.9383835279655808, 0.9376152427781193, 0.9378457283343578, 0.9355024585125998, 0.9379225568531039, 0.9381146281499693, 0.9385371850030731, 0.9366164720344192, 0.9420328826060234], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'SFAdamW', 'seed': 42, 'trials': 20, 'log_file': 'comparison_results/run_SFAdamW_42_1756256609935.log', 'success': True}
  ✓ Success - Loss: 0.9420328826060234
Run 2/2
running SFAdamW
Running: python -m benchmark.SVHN --opt SFAdamW --steps 27000 --trials 20 --runtime-limit 227200 --step-hint 27000
{'runtime': 3619.9194469451904, 'attempts': 1, 'best_loss': 0.9413030116779348, 'loss_trajectory': [2.277458667755127, 2.120401382446289, 1.3078304529190063, 0.9044224619865417, 0.5765982866287231, 0.49467507004737854, 0.3169585168361664, 0.4458388686180115, 0.2693217098712921, 0.31119129061698914, 0.30321604013442993, 0.19431430101394653, 0.21306103467941284, 0.23993244767189026, 0.22503259778022766, 0.16760002076625824, 0.23329225182533264, 0.22594089806079865, 0.1237843781709671, 0.03354310989379883, 0.0879928395152092, 0.21443982422351837, 0.06519866734743118, 0.1191963404417038, 0.08033119142055511, 0.11716846376657486, 0.11614469438791275], 'test_accuracies': [0.1958743085433313, 0.21147049784880148, 0.5477489244007375, 0.7142363245236631, 0.782498463429625, 0.8443838352796558, 0.8829901659496004, 0.895359557467732, 0.9065765212046711, 0.9121465888137676, 0.9205977258758451, 0.9257068223724647, 0.9277811923786109, 0.925361094038107, 0.9279732636754764, 0.9349262446220037, 0.9330823601720959, 0.9388060848186847, 0.937039028887523, 0.9402658266748617, 0.9318146896127842, 0.9368853718500307, 0.9335433312845728, 0.9351567301782422, 0.9413030116779348, 0.934157959434542, 0.9386908420405654], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'SFAdamW', 'seed': 43, 'trials': 20, 'log_file': 'comparison_results/run_SFAdamW_43_1756260242416.log', 'success': True}
  ✓ Success - Loss: 0.9413030116779348

=== Aggregating Results ===

Results saved to: comparison_results
Plots: comparison_results/SVHN_*.png
