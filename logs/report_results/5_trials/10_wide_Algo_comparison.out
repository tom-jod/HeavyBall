/var/spool/slurmd/job20847/slurm_script: line 15: cd: HeavyBall: No such file or directory
Current directory /home/tomjodrell/HeavyBall
CUDA_VISIBLE_DEVICES 3
Running comparison for CIFAR10_wide
Optimizers: AdamW, NAdamW, SFAdamW
Runs per optimizer: 1
Steps per run: 78000
Optuna trials per run: 5

=== Running AdamW ===
Run 1/1
running AdamW
Running: python -m benchmark.CIFAR10_wide --opt AdamW --steps 78000 --trials 5 --runtime-limit 7200 --step-hint 78000
{'runtime': 33109.79893898964, 'attempts': 1, 'best_loss': 0.9616, 'loss_trajectory': [2.3183577060699463, 1.2406691312789917, 0.7021794319152832, 0.6343234777450562, 0.5543971657752991, 0.5758302807807922, 0.48143574595451355, 0.4174961447715759, 0.6704684495925903, 0.544359564781189, 0.4463135898113251, 0.45689547061920166, 0.5146847367286682, 0.43679726123809814, 0.4087858200073242, 0.6029466986656189, 0.5816175937652588, 0.38085147738456726, 0.4097522795200348, 0.5111985802650452, 0.43063902854919434, 0.302872896194458, 0.4027004837989807, 0.415893018245697, 0.441645085811615, 0.4761802554130554, 0.41920357942581177, 0.428888201713562, 0.4965665638446808, 0.3343481421470642, 0.3771369755268097, 0.4233868718147278, 0.2888617515563965, 0.3980823755264282, 0.34317177534103394, 0.3603023290634155, 0.21214649081230164, 0.2966328263282776, 0.34538543224334717, 0.3501037061214447, 0.3217359781265259, 0.32206881046295166, 0.2411702424287796, 0.23313583433628082, 0.2814309298992157, 0.2415958195924759, 0.27108725905418396, 0.2339995950460434, 0.283111035823822, 0.2535822093486786, 0.2098262906074524, 0.26134219765663147, 0.14808963239192963, 0.19005537033081055, 0.150901660323143, 0.16732867062091827, 0.13849779963493347, 0.14194855093955994, 0.11394527554512024, 0.12210844457149506, 0.0884665921330452, 0.14565518498420715, 0.12680740654468536, 0.0716981291770935, 0.05071302503347397, 0.07126349210739136, 0.041751377284526825, 0.06600843369960785, 0.07003997266292572, 0.0545484721660614, 0.043591201305389404, 0.042791713029146194, 0.028055090457201004, 0.025353360921144485, 0.020736414939165115, 0.04659156873822212, 0.016901424154639244, 0.03425610810518265], 'test_accuracies': [0.1338, 0.6198, 0.7334, 0.7815, 0.7987, 0.8025, 0.803, 0.8021, 0.781, 0.8129, 0.8053, 0.7854, 0.8331, 0.8377, 0.838, 0.7807, 0.787, 0.8568, 0.8426, 0.8458, 0.8503, 0.8837, 0.8747, 0.8515, 0.853, 0.8687, 0.8729, 0.8631, 0.7935, 0.876, 0.8633, 0.8732, 0.8787, 0.8783, 0.8742, 0.866, 0.8947, 0.8938, 0.8857, 0.8771, 0.8883, 0.901, 0.8808, 0.9065, 0.8931, 0.912, 0.8914, 0.914, 0.8825, 0.9143, 0.9203, 0.9274, 0.9229, 0.9248, 0.9145, 0.9118, 0.931, 0.9289, 0.9346, 0.9427, 0.9372, 0.9456, 0.9414, 0.9297, 0.9456, 0.9502, 0.9487, 0.9515, 0.9562, 0.9552, 0.9588, 0.9581, 0.9585, 0.9601, 0.9615, 0.9604, 0.9616, 0.9616], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 78000, 'optimizer': 'AdamW', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_AdamW_42_1755708272876.log', 'success': True}
  ✓ Success - Loss: 0.9616

=== Running NAdamW ===
Run 1/1
running NAdamW
Running: python -m benchmark.CIFAR10_wide --opt NAdamW --steps 78000 --trials 5 --runtime-limit 7200 --step-hint 78000
{'runtime': 22172.965403556824, 'attempts': 1, 'best_loss': 0.9538, 'loss_trajectory': [2.3517184257507324, 0.9029028415679932, 0.6902800798416138, 0.45116785168647766, 0.5259398221969604, 0.36200663447380066, 0.22922399640083313, 0.27641886472702026, 0.3905322849750519, 0.31122100353240967, 0.2844367027282715, 0.23356345295906067, 0.2702715992927551, 0.23007002472877502, 0.22600038349628448, 0.3021954298019409, 0.135935977101326, 0.20061561465263367, 0.13447488844394684, 0.2048468291759491, 0.16808420419692993, 0.16731354594230652, 0.15140368044376373, 0.13568973541259766, 0.13516086339950562, 0.20152397453784943, 0.10698262602090836, 0.15232661366462708, 0.17050933837890625, 0.07226309925317764, 0.15917843580245972, 0.08958826959133148, 0.07298976182937622, 0.1639387458562851, 0.13445666432380676, 0.05232570692896843, 0.03099946677684784, 0.18606814742088318, 0.055333007127046585, 0.0883517786860466, 0.033981967717409134, 0.06714770197868347, 0.09441420435905457, 0.0662236213684082, 0.08499559015035629, 0.06354697793722153, 0.02729686163365841, 0.05145592615008354, 0.03796941787004471, 0.1070917621254921, 0.02180522121489048, 0.017979180440306664, 0.04286929965019226, 0.040794964879751205, 0.028066350147128105, 0.01854860410094261, 0.05077360197901726, 0.00739357341080904, 0.004927868023514748, 0.019849546253681183, 0.017151780426502228, 0.01072694081813097, 0.015958119183778763, 0.010825958102941513, 0.04561667516827583, 0.011338355951011181, 0.001267536310479045, 0.002846992574632168, 0.05999300256371498, 0.0008379487553611398, 0.000796950829681009, 0.003781305393204093], 'test_accuracies': [0.128, 0.7044, 0.7373, 0.8009, 0.8431, 0.8387, 0.8717, 0.8797, 0.89, 0.8859, 0.8988, 0.8995, 0.9077, 0.9119, 0.9057, 0.909, 0.9129, 0.9162, 0.914, 0.9179, 0.9141, 0.9263, 0.9186, 0.9168, 0.92, 0.9151, 0.9265, 0.9207, 0.9216, 0.9188, 0.9205, 0.9233, 0.9169, 0.9198, 0.9139, 0.924, 0.9257, 0.9272, 0.9256, 0.9273, 0.9337, 0.9336, 0.9347, 0.9282, 0.9335, 0.9303, 0.9286, 0.9329, 0.9362, 0.9364, 0.9389, 0.94, 0.9381, 0.9383, 0.9452, 0.9413, 0.9412, 0.9447, 0.9442, 0.946, 0.9475, 0.9504, 0.9508, 0.9484, 0.9467, 0.9499, 0.9528, 0.9522, 0.9528, 0.9538, 0.9516, 0.9535], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 78000, 'optimizer': 'NAdamW', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_NAdamW_42_1755741388503.log', 'success': True}
  ✓ Success - Loss: 0.9538

=== Running SFAdamW ===
Run 1/1
running SFAdamW
Running: python -m benchmark.CIFAR10_wide --opt SFAdamW --steps 78000 --trials 5 --runtime-limit 7200 --step-hint 78000
{'runtime': 17900.04065465927, 'attempts': 1, 'best_loss': 0.9348, 'loss_trajectory': [2.323212146759033, 0.9627697467803955, 0.8505194187164307, 0.5717082023620605, 0.379477322101593, 0.40567901730537415, 0.3951110541820526, 0.39711591601371765, 0.24112768471240997, 0.26489806175231934, 0.27691543102264404, 0.2083132565021515, 0.2552032172679901, 0.23762111365795135, 0.24265432357788086, 0.09786826372146606, 0.12952867150306702, 0.15672779083251953, 0.14926783740520477, 0.12656520307064056, 0.09432285279035568, 0.07622789591550827, 0.0802883580327034, 0.06532297283411026, 0.06329978257417679, 0.09551813453435898, 0.06582418829202652, 0.06114393472671509, 0.09172341227531433, 0.044582951813936234, 0.04743751510977745, 0.06663037836551666, 0.1444149762392044, 0.10755142569541931, 0.17715422809123993, 0.03953301161527634, 0.07016699016094208, 0.09538988023996353, 0.021580183878540993, 0.07260093837976456, 0.05396391823887825, 0.04265524074435234, 0.1119270846247673, 0.058091629296541214, 0.10467078536748886, 0.06260102242231369, 0.01822206750512123, 0.0640016570687294, 0.016204893589019775, 0.025451313704252243, 0.02925817109644413, 0.03595666214823723, 0.05343034490942955, 0.03264628350734711, 0.03554697334766388, 0.004503560718148947, 0.03491702675819397, 0.07584387809038162, 0.027877310290932655, 0.04857398942112923, 0.09513549506664276, 0.003110631136223674, 0.04130098223686218, 0.05313606187701225, 0.01966376043856144, 0.02849990874528885, 0.014334374107420444, 0.027739204466342926, 0.041302792727947235, 0.011282168328762054, 0.04451678693294525, 0.008316200226545334, 0.04148019477725029, 0.009321138262748718, 0.024266179651021957, 0.03929692879319191, 0.011796406470239162, 0.01105177029967308], 'test_accuracies': [0.1201, 0.6682, 0.7821, 0.8242, 0.8478, 0.8659, 0.8748, 0.887, 0.8969, 0.9003, 0.9002, 0.908, 0.9108, 0.9116, 0.9112, 0.9195, 0.9183, 0.9192, 0.9177, 0.9254, 0.9228, 0.9192, 0.9216, 0.923, 0.9244, 0.925, 0.9231, 0.9249, 0.9283, 0.9269, 0.9245, 0.9266, 0.9266, 0.9261, 0.9263, 0.9252, 0.928, 0.9273, 0.9293, 0.9296, 0.9292, 0.9255, 0.9288, 0.9322, 0.9301, 0.9311, 0.9307, 0.9289, 0.9285, 0.9303, 0.9303, 0.9305, 0.9301, 0.9308, 0.9335, 0.9319, 0.9325, 0.9325, 0.9321, 0.9325, 0.9345, 0.9321, 0.9303, 0.9312, 0.9328, 0.9333, 0.9312, 0.9311, 0.9307, 0.933, 0.9316, 0.9339, 0.9348, 0.9311, 0.9308, 0.9321, 0.9319, 0.9345], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 78000, 'optimizer': 'SFAdamW', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_SFAdamW_42_1755763567156.log', 'success': True}/home/tomjodrell/HeavyBall/benchmark/benchmark_runner.py:289: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
  plt.legend()

  ✓ Success - Loss: 0.9348

=== Aggregating Results ===

Results saved to: comparison_results
Plots: comparison_results/CIFAR10_wide_*.png
