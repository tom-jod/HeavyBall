/var/spool/slurmd/job21830/slurm_script: line 15: cd: HeavyBall: No such file or directory
Current directory /home/tomjodrell/HeavyBall
CUDA_VISIBLE_DEVICES 1
Running comparison for Tolstoi_RNN
Optimizers: AdamW, NAdamW, SFAdamW, ExternalDistributedShampoo
Runs per optimizer: 2
Steps per run: 27000
Optuna trials per run: 5

=== Running AdamW ===
Run 1/2
running AdamW
Running: python -m benchmark.Tolstoi_RNN --opt AdamW --steps 27000 --trials 5 --runtime-limit 99999 --step-hint 27000
{'runtime': 7302.2900586128235, 'attempts': 1, 'best_loss': 0.47716221450327984, 'loss_trajectory': [4.710387706756592, 3.1378366947174072, 2.601872205734253, 2.501054048538208, 2.25616192817688, 2.2293691635131836, 2.177877426147461, 2.0894594192504883, 2.043362855911255, 2.045285224914551, 2.0143747329711914, 2.0089571475982666, 1.9730037450790405, 1.978713870048523, 1.9427039623260498, 1.964040994644165, 1.9887545108795166, 1.9083632230758667, 1.9518349170684814, 1.9119873046875, 1.9076876640319824, 1.9048572778701782, 1.8853007555007935, 1.9281468391418457, 1.922857642173767, 2.0343244075775146, 1.9425413608551025], 'test_accuracies': [0.001662302813213645, 0.1585169508593951, 0.3121168665776337, 0.3482773055864554, 0.3790292104472201, 0.3999129295038841, 0.41430029095799237, 0.42777242065274984, 0.4373826794783207, 0.44451678973249836, 0.4498375097218392, 0.4559132641520542, 0.45985901396536394, 0.46255909793726585, 0.46561220474270826, 0.4684656691259176, 0.4706037610736009, 0.4720446693335234, 0.47350770155580413, 0.47463357574668374, 0.4754065510477896, 0.4763862335658312, 0.4766301858846641, 0.47685263395997235, 0.4770502622959963, 0.47713299476027726, 0.47716221450327984], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'AdamW', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_AdamW_42_1757686561906.log', 'success': True}
  ✓ Success - Loss: 0.47716221450327984
Run 2/2
running AdamW
Running: python -m benchmark.Tolstoi_RNN --opt AdamW --steps 27000 --trials 5 --runtime-limit 99999 --step-hint 27000
{'runtime': 7411.081698179245, 'attempts': 1, 'best_loss': 0.4785956241653162, 'loss_trajectory': [4.703415393829346, 3.154719829559326, 2.604679822921753, 2.496215343475342, 2.2758758068084717, 2.234677314758301, 2.190307140350342, 2.092264413833618, 2.029083490371704, 2.0475056171417236, 2.0121707916259766, 2.01621675491333, 1.9875564575195312, 1.9618810415267944, 1.9197410345077515, 1.9585992097854614, 1.9617363214492798, 1.9138764142990112, 1.9574503898620605, 1.910386323928833, 1.903562068939209, 1.8938724994659424, 1.8718253374099731, 1.89169180393219, 1.9147382974624634, 2.0057239532470703, 1.9470725059509277], 'test_accuracies': [0.012168179297052927, 0.15861452558973993, 0.3075392514416209, 0.34642694909319643, 0.3771781722632442, 0.3998917970916595, 0.4155874159893656, 0.4262738475553641, 0.43652697171293386, 0.4428626672078878, 0.4481913815701816, 0.4543538656511541, 0.45784963761941205, 0.46135953917707534, 0.4648910999079717, 0.4685671170989722, 0.47128538981863927, 0.4729179151419001, 0.47471754764863183, 0.47574643584205845, 0.4759726022303681, 0.47755818385198634, 0.4776045698066787, 0.47805495046897223, 0.4784010634375184, 0.47856107484034494, 0.4785956241653162], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'AdamW', 'seed': 43, 'trials': 5, 'log_file': 'comparison_results/run_AdamW_43_1757693869263.log', 'success': True}
  ✓ Success - Loss: 0.4785956241653162

=== Running NAdamW ===
Run 1/2
running NAdamW
Running: python -m benchmark.Tolstoi_RNN --opt NAdamW --steps 27000 --trials 5 --runtime-limit 99999 --step-hint 27000
{'runtime': 4952.856800794601, 'attempts': 1, 'best_loss': 0.5996348616632634, 'loss_trajectory': [4.725154876708984, 1.7430704832077026, 1.5937384366989136, 1.5782856941223145, 1.4980157613754272, 1.583418607711792, 1.4949642419815063, 1.530507206916809, 1.5213477611541748, 1.4738372564315796, 1.440423846244812, 1.4540246725082397, 1.4071435928344727, 1.4101676940917969, 1.4765485525131226, 1.4634796380996704, 1.3843936920166016, 1.3691376447677612, 1.4554646015167236, 1.4267840385437012, 1.5215872526168823, 1.4314886331558228, 1.4184849262237549, 1.3979820013046265, 1.37760591506958, 1.4220805168151855, 1.3776510953903198], 'test_accuracies': [8.211274544739052e-05, 0.5109170909158515, 0.5469842932261633, 0.5578995559714558, 0.5632161238446117, 0.5684693254670357, 0.569933070365975, 0.5697941603894313, 0.5766177915079929, 0.5753548355111286, 0.57885528635658, 0.5808770880651448, 0.5832205548342717, 0.5836907045273559, 0.586875501584931, 0.5881529590025005, 0.5894822249145563, 0.5905767413324574, 0.5932480083785986, 0.5932825886895116, 0.5947396716109901, 0.5961609657698302, 0.597102783467141, 0.5981324772950513, 0.5990882076801755, 0.5995256981907309, 0.5996348616632634], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'NAdamW', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_NAdamW_42_1757701285496.log', 'success': True}
  ✓ Success - Loss: 0.5996348616632634
Run 2/2
running NAdamW
Running: python -m benchmark.Tolstoi_RNN --opt NAdamW --steps 27000 --trials 5 --runtime-limit 99999 --step-hint 27000
{'runtime': 4945.422981977463, 'attempts': 1, 'best_loss': 0.5994345065643717, 'loss_trajectory': [4.711210250854492, 1.9920932054519653, 1.6916576623916626, 1.5606168508529663, 1.5176870822906494, 1.5355216264724731, 1.4937968254089355, 1.370882272720337, 1.4287749528884888, 1.4685719013214111, 1.504641056060791, 1.4786272048950195, 1.34263014793396, 1.4643535614013672, 1.452810525894165, 1.4125338792800903, 1.4034550189971924, 1.3958892822265625, 1.4337769746780396, 1.4592701196670532, 1.3836764097213745, 1.379410743713379, 1.4352705478668213, 1.371901512145996, 1.3796250820159912, 1.3700199127197266, 1.4058067798614502], 'test_accuracies': [0.016527467488000692, 0.4610270910088093, 0.5277195586362468, 0.5522247596265575, 0.5637584397958646, 0.5704263355715512, 0.5767541916232606, 0.5789654413792462, 0.5836498960421657, 0.5855366610168966, 0.5866927774868542, 0.5890515513111702, 0.5903464538139046, 0.5926541008344514, 0.5935033325380275, 0.5940595301911523, 0.5952285987847313, 0.5965888196525236, 0.5971535384396099, 0.5976527529459884, 0.5980516659591544, 0.5981339646202518, 0.5990409851050579, 0.5988124637851807, 0.5992243908938515, 0.5994046361165939, 0.5994345065643717], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'NAdamW', 'seed': 43, 'trials': 5, 'log_file': 'comparison_results/run_NAdamW_43_1757706243367.log', 'success': True}
  ✓ Success - Loss: 0.5994345065643717

=== Running SFAdamW ===
Run 1/2
running SFAdamW
Running: python -m benchmark.Tolstoi_RNN --opt SFAdamW --steps 27000 --trials 5 --runtime-limit 99999 --step-hint 27000
{'runtime': 7687.4339163303375, 'attempts': 1, 'best_loss': 0.5952147170828596, 'loss_trajectory': [4.727771282196045, 1.886535882949829, 1.6806919574737549, 1.6239173412322998, 1.5826704502105713, 1.5726410150527954, 1.523138165473938, 1.4957295656204224, 1.6197861433029175, 1.519572377204895, 1.4611835479736328, 1.493256688117981, 1.4513137340545654, 1.4459506273269653, 1.4671268463134766, 1.4918478727340698, 1.506754755973816, 1.5034303665161133, 1.5061986446380615, 1.4293088912963867, 1.4383535385131836, 1.4862310886383057, 1.446018099784851, 1.4588476419448853, 1.4627963304519653, 1.4276539087295532, 1.4014863967895508], 'test_accuracies': [0.007810006600005578, 0.49587230073715555, 0.5369098030223688, 0.5525145711390742, 0.5615049252154297, 0.5670274256569794, 0.5713473307160541, 0.574741313865899, 0.5779433700929888, 0.5794271319102523, 0.5817573986682242, 0.5835433973606174, 0.5857055653849849, 0.5852505058454979, 0.5867074958091514, 0.5883095309658009, 0.588866751155001, 0.5895661658305626, 0.5903075044852151, 0.5906592259092049, 0.5924688978610404, 0.592658562810053, 0.5934186169734791, 0.5939468033353268, 0.5946855081849365, 0.5949713225109767, 0.5952147170828596], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'SFAdamW', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_SFAdamW_42_1757711193724.log', 'success': True}/home/tomjodrell/HeavyBall/benchmark/benchmark_runner.py:289: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
  plt.legend()

  ✓ Success - Loss: 0.5952147170828596
Run 2/2
running SFAdamW
Running: python -m benchmark.Tolstoi_RNN --opt SFAdamW --steps 27000 --trials 5 --runtime-limit 99999 --step-hint 27000
{'runtime': 7117.836507558823, 'attempts': 1, 'best_loss': 0.5944582263027265, 'loss_trajectory': [4.716119289398193, 1.885856032371521, 1.6263009309768677, 1.6043152809143066, 1.5002130270004272, 1.5171785354614258, 1.454158902168274, 1.475334644317627, 1.520461916923523, 1.4821670055389404, 1.457829236984253, 1.4998493194580078, 1.454184889793396, 1.5484788417816162, 1.414109230041504, 1.465944766998291, 1.4727134704589844, 1.5647177696228027, 1.4613932371139526, 1.4483554363250732, 1.385620355606079, 1.4920154809951782, 1.5103652477264404, 1.4095433950424194, 1.476716160774231, 1.4726357460021973, 1.4709683656692505], 'test_accuracies': [0.0006987329848447759, 0.4932805746033025, 0.54301558283007, 0.5590407991894077, 0.5665995407883443, 0.5721747483166887, 0.5746111729108504, 0.5778041502570284, 0.5800811211953136, 0.5816539056230189, 0.583446845166348, 0.5841258091204021, 0.5856871287496863, 0.5868902818791114, 0.5872928512333954, 0.588159559008078, 0.5890009822543512, 0.5897992730698083, 0.591160981262801, 0.5909130317574917, 0.5915649759704023, 0.5920288665032675, 0.5927775798120393, 0.5929225320472101, 0.5941450513901843, 0.5937358820303228, 0.5944582263027265], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'SFAdamW', 'seed': 43, 'trials': 5, 'log_file': 'comparison_results/run_SFAdamW_43_1757718886181.log', 'success': True}
  ✓ Success - Loss: 0.5944582263027265

=== Running ExternalDistributedShampoo ===
Run 1/2
running ExternalDistributedShampoo
Running: python -m benchmark.Tolstoi_RNN --opt ExternalDistributedShampoo --steps 27000 --trials 5 --runtime-limit 99999 --step-hint 27000
{'runtime': 5266.181201696396, 'attempts': 1, 'best_loss': 0.5935312508714796, 'loss_trajectory': [4.7345380783081055, 1.7592133283615112, 1.6629722118377686, 1.6534041166305542, 1.5626100301742554, 1.5558377504348755, 1.6507084369659424, 1.543102741241455, 1.490963339805603, 1.503141164779663, 1.4738017320632935, 1.4408286809921265, 1.489997386932373, 1.481590747833252, 1.5047744512557983, 1.524512767791748, 1.5102684497833252, 1.4383903741836548, 1.461854338645935, 1.495033621788025, 1.4722079038619995, 1.443652868270874, 1.4681695699691772, 1.4374146461486816, 1.4151856899261475, 1.406861662864685, 1.4372845888137817], 'test_accuracies': [0.0048880322997456056, 0.5182499140140119, 0.5426171655919709, 0.5516200070028228, 0.5591204950314043, 0.564811528009742, 0.5692557796527715, 0.5711937643890966, 0.575068091606838, 0.5756519287199398, 0.5806180146067729, 0.5820276890374837, 0.580746575278796, 0.5851498325209852, 0.5861250220774834, 0.5858775683472408, 0.5868250874578204, 0.5868052254692047, 0.5895314305899414, 0.5904255609230092, 0.5901237268651213, 0.5903307129555321, 0.591989142526036, 0.5923728104558962, 0.5932580788096441, 0.5924402048790464, 0.5935312508714796], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'ExternalDistributedShampoo', 'seed': 42, 'trials': 5, 'log_file': 'comparison_results/run_ExternalDistributedShampoo_42_1757726009067.log', 'success': True}
  ✓ Success - Loss: 0.5935312508714796
Run 2/2
running ExternalDistributedShampoo
Running: python -m benchmark.Tolstoi_RNN --opt ExternalDistributedShampoo --steps 27000 --trials 5 --runtime-limit 99999 --step-hint 27000
{'runtime': 5270.116009712219, 'attempts': 1, 'best_loss': 0.5926910670628736, 'loss_trajectory': [4.724420070648193, 1.7928019762039185, 1.6866894960403442, 1.6447279453277588, 1.5766881704330444, 1.564003348350525, 1.6458185911178589, 1.5616248846054077, 1.5055766105651855, 1.5219929218292236, 1.4876587390899658, 1.4641985893249512, 1.4991166591644287, 1.5043632984161377, 1.5265535116195679, 1.5014920234680176, 1.513149380683899, 1.4253417253494263, 1.4718252420425415, 1.5100938081741333, 1.4858660697937012, 1.4636341333389282, 1.4755198955535889, 1.427024006843567, 1.4320875406265259, 1.4143375158309937, 1.4400628805160522], 'test_accuracies': [0.0002866199605239103, 0.514478491108584, 0.5402691438894174, 0.5501867832564366, 0.5581959365036083, 0.5633836028593827, 0.5675476486318157, 0.5714899590055992, 0.5739057779485447, 0.575101308536317, 0.5786954608694036, 0.5807838203806933, 0.580455431370787, 0.583591115710802, 0.5842716909338234, 0.5852142522937344, 0.5858446612771785, 0.5855736272453188, 0.5883150464634196, 0.5893373656372104, 0.5882554604975723, 0.5901825071964849, 0.5910184459310811, 0.5912543728910193, 0.5917217958212359, 0.5918825508866628, 0.5926910670628736], 'grad_variances': [], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 27000, 'optimizer': 'ExternalDistributedShampoo', 'seed': 43, 'trials': 5, 'log_file': 'comparison_results/run_ExternalDistributedShampoo_43_1757731280326.log', 'success': True}
  ✓ Success - Loss: 0.5926910670628736

=== Aggregating Results ===

Results saved to: comparison_results
Plots: comparison_results/Tolstoi_RNN_*.png
