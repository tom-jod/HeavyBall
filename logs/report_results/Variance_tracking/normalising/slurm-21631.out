/var/spool/slurmd/job21631/slurm_script: line 15: cd: HeavyBall: No such file or directory
Current directory /home/tomjodrell/HeavyBall
CUDA_VISIBLE_DEVICES 1
Running comparison for MNIST
Optimizers: AdamW
Runs per optimizer: 1
Steps per run: 270000
Optuna trials per run: 1

=== Running AdamW ===
Run 1/1
running AdamW
Running: python -m benchmark.MNIST --opt AdamW --steps 270000 --trials 1 --runtime-limit 992500 --step-hint 270000
{'runtime': 24641.120789051056, 'attempts': 1, 'best_loss': 0.9861, 'loss_trajectory': [2.3057010173797607, 0.22154612839221954, 0.15450623631477356, 0.11639404296875, 0.056642357259988785, 0.06521590054035187, 0.07672452926635742, 0.052791085094213486, 0.023726800456643105, 0.01799156703054905, 0.11420193314552307, 0.024222057312726974, 0.12480572611093521, 0.04124138504266739, 0.03719906881451607, 0.0047004190273582935, 0.07361773401498795, 0.038033824414014816, 0.06623227894306183, 0.07357805967330933, 0.026479629799723625, 0.04530123993754387, 0.06272073090076447, 0.03793740272521973, 0.03561606630682945, 0.08782270550727844, 0.030538517981767654, 0.03260442987084389, 0.052345406264066696, 0.05804334208369255, 0.09889428317546844, 0.04706782102584839, 0.06211867555975914, 0.01369454525411129, 0.07391919195652008, 0.08547770977020264, 0.10131219774484634, 0.11248219758272171, 0.058327604085206985, 0.07807941734790802, 0.051622435450553894, 0.09093993157148361, 0.020535480231046677, 0.04623191058635712, 0.06972090899944305, 0.09091275930404663, 0.05268440023064613, 0.0841967761516571, 0.10100933164358139, 0.05458790808916092, 0.041599683463573456, 0.014974179677665234, 0.0209241583943367, 0.20119063556194305, 0.023269787430763245, 0.03702051192522049, 0.09952264279127121, 0.046032603830099106, 0.05980415269732475, 0.04926379770040512, 0.007699546404182911, 0.039714206010103226, 0.057636115700006485, 0.051826111972332, 0.08788830041885376, 0.08007676899433136, 0.08320865035057068, 0.05071038007736206, 0.03400511294603348, 0.0447213277220726, 0.07710667699575424, 0.01180151104927063, 0.03405555337667465, 0.009159528650343418, 0.06619317084550858, 0.05231639742851257, 0.043295107781887054, 0.08569438755512238, 0.021851925179362297, 0.08765719085931778, 0.05608883872628212, 0.06908924132585526, 0.04370557889342308, 0.014347085729241371, 0.017744235694408417, 0.05515054613351822, 0.03277307003736496, 0.05163435637950897, 0.07083010673522949, 0.11084076762199402, 0.03622853755950928, 0.036716654896736145, 0.03303655609488487, 0.09691954404115677, 0.055004168301820755, 0.013296619988977909, 0.028952084481716156, 0.10814633965492249, 0.02323523350059986, 0.08966723084449768, 0.03178897127509117, 0.06736123561859131, 0.07102254033088684, 0.07377397269010544, 0.07620669901371002, 0.20668412744998932, 0.05446244403719902, 0.09272530674934387, 0.057071395218372345, 0.053264863789081573, 0.018199101090431213, 0.03723779693245888, 0.031996577978134155, 0.04280954226851463, 0.014659744687378407, 0.04604472219944, 0.07664193958044052, 0.013921508565545082, 0.05993270128965378, 0.05477619543671608, 0.05664407089352608, 0.007544845808297396, 0.016376148909330368, 0.021297205239534378, 0.04259864613413811, 0.06741316616535187, 0.0377151295542717, 0.06140138581395149, 0.11647554486989975, 0.019305052235722542, 0.02743244357407093, 0.04572048410773277, 0.01005853246897459, 0.050973355770111084, 0.03682602941989899, 0.020711667835712433, 0.02364027313888073, 0.04881087690591812, 0.047104962170124054, 0.09906218945980072, 0.06978268176317215, 0.01973806507885456, 0.0479850172996521, 0.007125799544155598, 0.022000212222337723, 0.10245341807603836, 0.014866515062749386, 0.024570181965827942, 0.01789105124771595, 0.051399532705545425, 0.07692839950323105, 0.0320572666823864, 0.05589672550559044, 0.023415206000208855, 0.057812586426734924, 0.019003303721547127, 0.031442154198884964, 0.04768132418394089, 0.00505978986620903, 0.03364280238747597, 0.01308387704193592, 0.07625924050807953, 0.006390671245753765, 0.009262132458388805, 0.005487900227308273, 0.02267649583518505, 0.00568644842132926, 0.013897721655666828, 0.014122209511697292, 0.020555974915623665, 0.02589670941233635, 0.04604518041014671, 0.011108913458883762, 0.06529213488101959, 0.05908171087503433, 0.008652028627693653, 0.028384733945131302, 0.036614641547203064, 0.01691379025578499, 0.009346699342131615, 0.007923637516796589, 0.016287565231323242, 0.02958652563393116, 0.01757138781249523, 0.013090694323182106, 0.03238563984632492, 0.014297304674983025, 0.0019417715957388282, 0.024266762658953667, 0.002044272143393755, 0.010572610422968864, 0.006219147704541683, 0.004612630233168602, 0.021278589963912964, 0.006886434741318226, 0.018214715644717216, 0.0036691261921077967, 0.00954887829720974, 0.0017403116216883063, 0.006314423400908709, 0.020087912678718567, 0.031181033700704575, 0.007285448256880045, 0.014123664237558842, 0.0017391687724739313, 0.008644947782158852, 0.012637450359761715, 0.034216757863759995, 0.006145580671727657, 0.03731092810630798, 0.0056856973096728325, 0.026253024116158485, 0.00541898887604475, 0.0074388873763382435, 0.018862487748265266, 0.0005987226031720638, 0.009978380985558033, 0.026616031304001808, 0.008238418959081173, 0.0027609318494796753, 0.01338646188378334, 0.007504148408770561, 0.009247313253581524, 0.0020063985139131546, 0.012684046290814877, 0.0034753840882331133, 0.007733463309705257, 0.004333606455475092, 0.007378714624792337, 0.003439876949414611, 0.0023765580262988806, 0.008220920339226723, 0.0069717527367174625, 0.0025873477570712566, 0.005399272311478853, 0.0037777626421302557, 0.009212378412485123, 0.005306985229253769, 0.00423075444996357, 0.0014304791111499071, 0.005537220276892185, 0.002964304992929101, 0.0007710697245784104, 0.002990670735016465, 0.003967223223298788, 0.0023499056696891785, 0.004435522481799126, 0.002825105097144842, 0.003087281482294202, 0.001970909535884857, 0.0038019760977476835, 0.005985239986330271, 0.002051805378869176, 0.004273660015314817, 0.005999674554914236, 0.00405972870066762, 0.0024226128589361906, 0.002174432622268796, 0.0033344151452183723, 0.0046138158068060875, 0.002788620302453637, 0.0017122190911322832, 0.002027590526267886, 0.004293965175747871, 0.0026827980764210224, 0.004114465322345495, 0.0021873076912015676, 0.004030502401292324, 0.005562817677855492, 0.0023821766953915358], 'test_accuracies': [0.069, 0.9218, 0.9569, 0.9696, 0.9696, 0.9699, 0.9671, 0.9735, 0.9703, 0.9752, 0.9714, 0.9675, 0.9671, 0.9692, 0.969, 0.9759, 0.9696, 0.9761, 0.9673, 0.9627, 0.972, 0.9685, 0.9689, 0.9679, 0.9684, 0.9766, 0.9657, 0.9719, 0.9709, 0.9618, 0.9628, 0.9658, 0.971, 0.9717, 0.9704, 0.9684, 0.9702, 0.9672, 0.9696, 0.9707, 0.9688, 0.9747, 0.9689, 0.974, 0.9678, 0.9649, 0.9721, 0.9728, 0.9696, 0.9699, 0.9687, 0.9726, 0.9666, 0.9622, 0.972, 0.9723, 0.9711, 0.9673, 0.973, 0.9672, 0.9769, 0.9702, 0.9684, 0.969, 0.9633, 0.9725, 0.9701, 0.9703, 0.967, 0.9652, 0.9719, 0.9758, 0.975, 0.9753, 0.9676, 0.9656, 0.9643, 0.9714, 0.9748, 0.9764, 0.9742, 0.9741, 0.969, 0.9665, 0.9723, 0.9749, 0.9727, 0.9741, 0.9726, 0.9709, 0.967, 0.9679, 0.9692, 0.974, 0.9769, 0.9706, 0.977, 0.9683, 0.9719, 0.9734, 0.969, 0.9764, 0.9694, 0.9769, 0.9762, 0.9727, 0.9682, 0.9769, 0.9728, 0.9745, 0.9749, 0.973, 0.9721, 0.9729, 0.9768, 0.9761, 0.9734, 0.9725, 0.9737, 0.9752, 0.9756, 0.9758, 0.973, 0.9752, 0.9767, 0.9798, 0.9736, 0.9754, 0.9643, 0.9698, 0.976, 0.9751, 0.9778, 0.9789, 0.9792, 0.9802, 0.9749, 0.9777, 0.9759, 0.9769, 0.9787, 0.9759, 0.977, 0.9764, 0.9725, 0.9685, 0.9794, 0.9744, 0.9774, 0.9716, 0.9723, 0.9813, 0.9766, 0.9749, 0.9765, 0.973, 0.9813, 0.978, 0.9762, 0.9778, 0.9764, 0.9729, 0.9803, 0.9803, 0.9813, 0.9768, 0.9797, 0.9791, 0.9801, 0.974, 0.981, 0.9792, 0.9757, 0.9764, 0.9801, 0.9756, 0.9766, 0.981, 0.9783, 0.9795, 0.977, 0.9768, 0.9766, 0.9784, 0.9801, 0.9762, 0.9809, 0.9809, 0.9822, 0.9837, 0.9837, 0.9809, 0.9713, 0.9821, 0.9838, 0.9821, 0.9824, 0.9818, 0.9838, 0.98, 0.9762, 0.9837, 0.9845, 0.9813, 0.9819, 0.9839, 0.9809, 0.9838, 0.9822, 0.9824, 0.9829, 0.983, 0.9823, 0.9846, 0.9779, 0.9831, 0.9824, 0.9847, 0.9838, 0.9814, 0.9811, 0.9831, 0.9825, 0.9834, 0.9844, 0.9835, 0.9846, 0.9858, 0.9854, 0.9839, 0.9828, 0.9848, 0.9821, 0.9842, 0.9861, 0.9851, 0.9857, 0.9849, 0.9854, 0.9852, 0.9845, 0.984, 0.9854, 0.9852, 0.9856, 0.9849, 0.9845, 0.9856, 0.9855, 0.9851, 0.9852, 0.9856, 0.9853, 0.9854, 0.9852, 0.9852, 0.9853, 0.9852, 0.9852, 0.9857, 0.9856, 0.9855, 0.9855, 0.9852, 0.9853, 0.9853, 0.9853, 0.9852, 0.9852, 0.9852], 'grad_variances': [0.878977358341217, 5.082035064697266, 5.780595302581787, 5.327284336090088, 4.535579204559326, 3.7085304260253906, 6.270664691925049, 8.775299072265625, 9.355098724365234, 16.84341812133789, 7.30656099319458, 11.119370460510254, 4.4361491203308105, 6.17349100112915, 6.071002006530762, 11.154068946838379, 13.346002578735352, 16.789329528808594, 6.555394649505615, 3.7160143852233887, 10.591205596923828, 4.090251445770264, 4.448166847229004, 13.366043090820312, 9.379521369934082, 17.80604362487793, 5.965860843658447, 11.628508567810059, 6.6295976638793945, 5.492010116577148, 3.5577635765075684, 5.258544921875, 9.308425903320312, 11.003068923950195, 8.798728942871094, 5.321353912353516, 6.8176679611206055, 5.449100494384766, 9.83485221862793, 10.847931861877441, 8.302803039550781, 19.194671630859375, 5.534530162811279, 8.289657592773438, 9.0253267288208, 3.311129093170166, 13.638813972473145, 8.896286010742188, 4.806535243988037, 6.674484729766846, 10.039681434631348, 7.766424179077148, 4.594057083129883, 3.2844367027282715, 8.434284210205078, 10.221967697143555, 15.85854721069336, 6.442953109741211, 14.268728256225586, 4.372591495513916, 18.902151107788086, 9.823789596557617, 10.532883644104004, 5.678213596343994, 4.159452438354492, 8.130647659301758, 6.999878406524658, 7.424560546875, 8.837079048156738, 4.051027774810791, 6.550594806671143, 14.242108345031738, 13.45898723602295, 13.2181978225708, 5.92153263092041, 4.5083184242248535, 5.0887017250061035, 9.609665870666504, 17.731109619140625, 12.958078384399414, 7.8011980056762695, 8.363935470581055, 7.251975059509277, 3.6329879760742188, 8.89258861541748, 11.754887580871582, 8.24853801727295, 12.624957084655762, 13.317831039428711, 7.870222091674805, 4.53455114364624, 5.130016326904297, 5.901359558105469, 7.121306419372559, 14.887353897094727, 5.593485355377197, 12.139158248901367, 6.743391036987305, 8.3319091796875, 10.287589073181152, 5.456186294555664, 13.37125301361084, 4.903554916381836, 12.880657196044922, 10.10177993774414, 8.008844375610352, 5.395053863525391, 10.604742050170898, 14.8251953125, 14.978879928588867, 10.82075023651123, 9.263152122497559, 5.4213080406188965, 9.236763000488281, 19.783620834350586, 13.695416450500488, 13.433438301086426, 9.868773460388184, 10.708463668823242, 5.51981258392334, 9.620414733886719, 7.379830360412598, 6.806694507598877, 8.572227478027344, 9.229676246643066, 16.881202697753906, 6.452012062072754, 14.39970588684082, 4.862461090087891, 5.990706443786621, 7.562653541564941, 7.848620891571045, 14.295830726623535, 17.546531677246094, 10.377182006835938, 19.967987060546875, 8.05854320526123, 16.805418014526367, 8.272106170654297, 13.412572860717773, 10.748954772949219, 12.079659461975098, 10.084939002990723, 11.835091590881348, 7.837533950805664, 3.523597240447998, 17.8004207611084, 8.186243057250977, 9.412328720092773, 5.375329971313477, 3.6460988521575928, 17.258228302001953, 9.764236450195312, 5.981307029724121, 7.5025811195373535, 5.400700569152832, 20.7716007232666, 10.826132774353027, 3.855121612548828, 6.634520530700684, 5.588429927825928, 5.991301536560059, 13.051881790161133, 14.192011833190918, 19.486007690429688, 6.429655075073242, 9.014519691467285, 14.891982078552246, 14.661958694458008, 7.037796974182129, 10.31093692779541, 9.884727478027344, 5.388200283050537, 4.714918613433838, 9.089762687683105, 8.456260681152344, 7.692934513092041, 12.108154296875, 13.17103099822998, 9.102214813232422, 6.835685729980469, 5.372708797454834, 6.332854747772217, 8.423015594482422, 10.827476501464844, 8.136202812194824, 10.5250825881958, 11.556218147277832, 18.20962142944336, 12.436966896057129, 23.743724822998047, 18.222688674926758, 4.354644298553467, 21.00872039794922, 14.746039390563965, 16.266515731811523, 17.51408576965332, 12.41384506225586, 12.04211711883545, 5.589119911193848, 5.104301452636719, 18.4326114654541, 20.47279167175293, 10.831368446350098, 7.337889671325684, 16.835725784301758, 9.930034637451172, 12.943367958068848, 12.825777053833008, 12.110700607299805, 14.431323051452637, 11.168737411499023, 9.169855117797852, 21.188373565673828, 6.318044185638428, 10.745610237121582, 9.318300247192383, 18.873884201049805, 11.733909606933594, 14.350400924682617, 8.175857543945312, 16.741744995117188, 8.393985748291016, 11.806440353393555, 15.64061450958252, 18.405433654785156, 16.64441680908203, 16.122953414916992, 19.66883087158203, 13.615647315979004, 11.386770248413086, 19.10320281982422, 7.575704574584961, 13.461882591247559, 13.158273696899414, 10.225905418395996, 27.778928756713867, 10.595765113830566, 39.37202453613281, 12.827897071838379, 14.178434371948242, 14.574490547180176, 22.89234161376953, 8.634421348571777, 31.350980758666992, 16.086387634277344, 12.581867218017578, 56.964630126953125, 34.91736602783203, 58.082275390625, 114.56182861328125, 161.34442138671875, 58.002384185791016, 52.33428192138672, 70.51258087158203, 181.4903106689453, 225.2943572998047, 216.12498474121094, 235.9560546875, 471.7090759277344, 627.9739379882812, 591.73046875, 681.0880126953125, 828.0097045898438, 912.6995239257812, 888.7203979492188, 906.635009765625, 932.1874389648438, 942.8700561523438, 949.4463500976562], 'config_str': '', 'mean_cond': 0.0, 'std_err_cond': None, 'memory_usage': None, 'steps': 270000, 'optimizer': 'AdamW', 'seed': 42, 'trials': 1, 'log_file': 'comparison_results/run_AdamW_42_1757257552751.log', 'success': True}
  ✓ Success - Loss: 0.9861

=== Aggregating Results ===

Results saved to: comparison_results
Plots: comparison_results/MNIST_*.png
