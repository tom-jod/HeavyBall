import matplotlib.pyplot as plt

mnist_l=[0.101, 0.9361, 0.96, 0.9672, 0.9651, 0.968, 0.9697, 0.9631, 0.974, 0.9717, 0.9727, 0.9754, 0.976, 0.9733, 0.9739, 0.9725, 0.9751, 0.975, 0.978, 0.975, 0.9774, 0.9734, 0.9757, 0.9783, 0.9732, 0.9766, 0.9736, 0.9748, 0.9747, 0.9757, 0.9768, 0.9772, 0.9764, 0.9758, 0.9744, 0.9747, 0.9788, 0.9764, 0.9763, 0.9775, 0.9762, 0.9769, 0.9764, 0.9769, 0.9777, 0.9798, 0.9802, 0.98, 0.9794, 0.9791, 0.9794, 0.9779, 0.9774, 0.9799, 0.9782, 0.9777, 0.9779, 0.9787, 0.9792, 0.9803, 0.9798, 0.9799, 0.9794, 0.9801, 0.9787, 0.9802, 0.9782, 0.9784, 0.9804, 0.9803, 0.9809, 0.9808, 0.9805, 0.9803, 0.9784, 0.9801, 0.9786, 0.9836, 0.9805, 0.9805, 0.9809, 0.9808, 0.9805, 0.9803, 0.9806, 0.9816, 0.9799, 0.9821, 0.9817, 0.9826, 0.9823, 0.9816, 0.9833, 0.9824, 0.9827, 0.9824, 0.9836, 0.9838, 0.9839, 0.9837, 0.9838, 0.984, 0.984, 0.9841, 0.9839, 0.9839, 0.9838, 0.984, 0.9841, 0.9841, 0.9838, 0.9839, 0.984, 0.9841, 0.9842, 0.9844, 0.9846, 0.9846, 0.9848, 0.9847, 0.9847, 0.9848, 0.9848, 0.9848, 0.9848, 0.9847, 0.9847, 0.9849, 0.9848, 0.9848, 0.9849, 0.9849, 0.9849, 0.9849, 0.9849, 0.9848, 0.9847, 0.9847, 0.9847, 0.9847, 0.9849, 0.9849, 0.9849, 0.9849, 0.9849, 0.9848, 0.9848, 0.9848, 0.9848, 0.9848, 0.9848, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.985, 0.9849, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.985, 0.985, 0.985, 0.985, 0.985, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.985, 0.985, 0.985, 0.985, 0.9851, 0.985, 0.985, 0.9851, 0.985, 0.985, 0.9851, 0.985, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851, 0.9851]
old_CIFAR_target_l= [0.0094, 0.244, 0.4061, 0.4997, 0.5644, 0.5935, 0.6046, 0.6239, 0.6423, 0.6666, 0.6606, 0.6673, 0.6831, 0.677, 0.6838, 0.6889, 0.6908, 0.6826, 0.6862, 0.6937, 0.6923, 0.6983, 0.7002, 0.6966, 0.6919, 0.709, 0.7003, 0.7088, 0.7028, 0.7112, 0.7111, 0.7192, 0.7078, 0.7115, 0.7171, 0.7178, 0.7175, 0.716, 0.7154, 0.722, 0.7231, 0.7255, 0.7252, 0.7245, 0.7302, 0.7263, 0.7239, 0.7293, 0.7275, 0.7307, 0.7317, 0.7314, 0.7337, 0.732, 0.7367, 0.7381, 0.7371, 0.737, 0.7394, 0.7384, 0.7371, 0.7385, 0.7388, 0.7399, 0.7391, 0.7385, 0.7415, 0.7404, 0.7409, 0.7401, 0.7391, 0.7385, 0.7407, 0.7408, 0.7383, 0.7408, 0.7394, 0.7376, 0.7417, 0.7361, 0.7377, 0.738, 0.7382, 0.7352, 0.735, 0.7382, 0.7295, 0.7284, 0.7293, 0.7274, 0.7252, 0.7261, 0.7239, 0.724, 0.7221, 0.7264, 0.7222, 0.7151, 0.7123, 0.7122, 0.7093, 0.7078, 0.7099, 0.7066, 0.7056, 0.7031, 0.6971, 0.7026, 0.7013, 0.7061, 0.6952, 0.691, 0.695, 0.6955, 0.6922, 0.698, 0.6893, 0.6983, 0.6982, 0.6864, 0.6949, 0.6946, 0.6951, 0.6842, 0.6908, 0.6983, 0.697, 0.6953, 0.6979, 0.6924, 0.6888, 0.6907, 0.6938, 0.6949, 0.6992, 0.693, 0.6908, 0.7008, 0.7043, 0.7046, 0.6925, 0.6975, 0.7012, 0.6996, 0.7075, 0.7007, 0.7036, 0.7011, 0.697, 0.7053, 0.7019, 0.7028, 0.7012, 0.7021, 0.712, 0.7068, 0.7032, 0.7098, 0.7089, 0.7106, 0.7099, 0.7081, 0.7137, 0.7138, 0.7155, 0.7112, 0.7094, 0.7088, 0.7173, 0.717, 0.7193, 0.7185, 0.7249, 0.7261, 0.723, 0.7257, 0.7239, 0.7257, 0.7271, 0.7253, 0.7286, 0.729, 0.7292, 0.7322, 0.7326]
l=[0.006680723955541371, 0.33378604826989994, 0.4544136685185931, 0.5027620248693168, 0.5271307947584181, 0.5415430069377524, 0.5500600197690307, 0.557177614516294, 0.5616114238969779, 0.5657172780709392, 0.5694065262590363, 0.5709881416801197, 0.5743966262506701, 0.5754834891409767, 0.5788810666600563, 0.5802001072113582, 0.5810775671078032, 0.582877385530185, 0.5839987667595212, 0.5851524663260279, 0.5865669125917571, 0.5862870475665191, 0.5873765752478101, 0.5887469904904145, 0.5892215092012754, 0.590776817557874, 0.5905143356459175, 0.5915292491796472, 0.5921320496890561, 0.5917221366665943, 0.5928164051969621, 0.5929723574414288, 0.5937605158539571, 0.5938280342208739, 0.5940846597898534, 0.5950258267823888, 0.5951143846037052, 0.5955707455527427, 0.5967283183619592, 0.5964567265831492, 0.5970825806331668, 0.5966586929510082, 0.5969779101221776, 0.5973669696058898, 0.5976983642521388, 0.5975248739646822, 0.5983081056124836, 0.5982794126304896, 0.5987159425768529, 0.5987420017538043, 0.5990055681737196, 0.5992972698286787, 0.5991958528415657, 0.6004697468758424, 0.600240481893365, 0.6006804512792546, 0.600305304483356, 0.6008312908433444, 0.6010341867894536, 0.6006907076259501, 0.6014264688111004, 0.6015153674777753, 0.6016906239639076, 0.6020637256876555, 0.6017691423401202, 0.6018459874754823, 0.6019724720894131, 0.6023627710107924, 0.6022422976695473, 0.6024126583768944, 0.6030121124046021, 0.6026947543899333, 0.6029244221896526, 0.6029661292671515, 0.6027935995438869, 0.6034964846449166, 0.6035346283391225, 0.6034223043005389, 0.6032309970966173, 0.6029547884124973, 0.6035151691677486, 0.6036822453652778, 0.6036396396954702, 0.6038117666014929, 0.6037955919399368, 0.6041426035007917, 0.6039116652774636, 0.6040282963619406, 0.6044760122332498, 0.604218178212545, 0.6043550121309962, 0.6045405869357072, 0.604267290930105, 0.6043371952145312, 0.6045660883657085, 0.6044243276825304, 0.6046422518103537, 0.6048163308307021, 0.6048316688718328, 0.6046791870528341, 0.6052340213245251, 0.6051822748019223, 0.6050259817120972, 0.6052653790975034, 0.6051000381127083, 0.6052798185463255, 0.605292677712122, 0.6050878606376288, 0.6051973649555197, 0.6051560606952625, 0.605098519801566, 0.6051757057822865, 0.6053093171628032, 0.605363852420157, 0.6054597229237095, 0.6053910890628922, 0.6054142975332092, 0.6054137707722006, 0.6053749144013361, 0.6054197820448862, 0.6054377538910596, 0.6054446327701122, 0.605412283447, 0.6054154440130513, 0.6054281172631977, 0.6054382186801848, 0.6054455003764792, 0.605396790476161, 0.6053949313196603, 0.6053612186151143, 0.6053482355055512, 0.6053351594381629, 0.6053227960474333, 0.6054543623557992, 0.6055489314498013, 0.6056129174193668, 0.6055366300309549, 0.605444075023162, 0.6053902834284085, 0.6052223396245123, 0.6053235087240919]
mars_tolstoi_l = [0.015367570733158366, 0.15867339887892862, 0.27934941916852324, 0.34488837314510407, 0.39651984494634784, 0.4333831070843158, 0.45993520839595076, 0.4772229779349109, 0.4883024661710982, 0.4965972788146018, 0.5044798235040762, 0.5097676054374131, 0.5163919349791, 0.5201703297214054, 0.524197758476979, 0.5293329346475504, 0.5328257319654073, 0.5355542920177115, 0.5386445199812845, 0.5417846043250177, 0.5432467379549898, 0.5464718787086299, 0.5476403275833754, 0.5492130810251389, 0.5520329876335107, 0.5538347271842765, 0.5548075927951488, 0.556254884159057, 0.5571289046159758, 0.5586049509337614, 0.5598282449252774, 0.5609351247339083, 0.5621728271883046, 0.5629199602140509, 0.5639935301353776, 0.5647184772268822, 0.5652258720218637, 0.5660587431482337, 0.5667088282046435, 0.567159208866937, 0.5688406919780495, 0.5692495824644359, 0.5697202589185286, 0.5704380172715638, 0.5716166605211216, 0.5718146606884457, 0.5722115286294608, 0.5731409829360419, 0.5734651268719382, 0.5735494086333031, 0.5744650432098957, 0.5748692548190886, 0.5750836465495605, 0.5752589959935177, 0.5761536840735358, 0.5761880784687987, 0.5771504708313838, 0.5769187889454555, 0.5774086147115054, 0.577737437524595, 0.5783727422868244, 0.5790231681885928, 0.5794366755802892, 0.5799128365460591, 0.5795248305843639, 0.5800496084926269, 0.5801406761752192, 0.5807634626170106, 0.5814214490885485, 0.5811178488319849, 0.5816295816588014, 0.5819722242018797, 0.5818352043677784, 0.5822571399356112, 0.5822197708899473, 0.5827523572555132, 0.5830718223142161, 0.58295317714353, 0.5831230730617519, 0.5838180257617119, 0.5838663948166717, 0.584399322027596, 0.5840924992330979, 0.584384789620949, 0.5849116745732461, 0.585289207286654, 0.5853205650596325, 0.5859148134491381, 0.5853433707127076, 0.5858019626495459, 0.586295041939472, 0.5868257381625956, 0.5859729120897849, 0.5866041576936544, 0.5866020816355619, 0.5869957270386426, 0.5869556002441693, 0.5871782652210692, 0.5874229612025024, 0.5877640854344384, 0.58800912226123, 0.5876086599509802, 0.5877424882330886, 0.5883379450743198, 0.5884581395420898, 0.5887664496617885, 0.5883454126862643, 0.5892390162583236, 0.5892904219355678, 0.5890879597926421, 0.5890922668385353, 0.5896193686924243, 0.5898434590226415, 0.5901438367412705, 0.5894476136177016, 0.5902976819417031, 0.5903597467828846, 0.5905464370814961, 0.590633414619787, 0.5908405866258478, 0.5906294174333105, 0.5904059158359852, 0.591046952997425, 0.5911168882677929, 0.5913534039606231, 0.5917293254050637, 0.5915860154248017, 0.5913206518202692, 0.5915176294515179, 0.5909485106607132, 0.5916214013701984, 0.5920566918788945, 0.5919849284379677, 0.5923567597381069, 0.591685573255414, 0.5926349515224942, 0.5926916867817071, 0.5926142838993949, 0.5923614696012419, 0.5920530975096598, 0.5924862190024386, 0.5931606590090076, 0.5935571241327809, 0.5936239917949226, 0.59386636383073, 0.5939912371756934, 0.5939976202796791, 0.5939212399334421, 0.5940514118744326, 0.5940665330139716, 0.5942021894666389, 0.5942124148273928, 0.5941568880199054, 0.5940077526826079, 0.5942209359613543, 0.5943055585680777, 0.594302150114493, 0.5941847753674158, 0.5941924288950103, 0.5941956514329448, 0.5944108178119587, 0.5943377839474231, 0.5943948910379361, 0.5943719924270359, 0.5945196404391327, 0.5944004065355548, 0.5945364038335808, 0.5945148376181726, 0.5945124517006634, 0.5944172319018861, 0.594353679735504, 0.5944960601375157, 0.5944422375568205, 0.5945019474664345, 0.5946186095368531, 0.5944075952740242, 0.5943822797596731, 0.5944249783873057, 0.5945787306299132, 0.5944343671276342, 0.5944269305016314, 0.594582882746098, 0.5943746572180202, 0.5944037840031977, 0.5944175417613029, 0.5944192769740368, 0.5946110179811419, 0.5946979955194328, 0.5944170769721777, 0.5944943249247816, 0.5947651730409913, 0.5946194771432202, 0.5947964998280281, 0.5948422040920035, 0.5948091111062911, 0.5947277420234439, 0.5947412828799573, 0.5947410040064822, 0.5947507645781109, 0.5945369925664726, 0.5948186237903863, 0.5946825335345354, 0.594762508250007, 0.5947460237290342, 0.5949154548581309, 0.594751911057953, 0.5948690998893802, 0.5948400660620277, 0.594769727974418, 0.594718105395582, 0.5949064999209859, 0.5949499422112188, 0.5949898521041004, 0.5949631732083154, 0.5950192887486947, 0.5949039280878266, 0.5948540407217245, 0.5949766830788871, 0.5949779844884376, 0.594947990096893, 0.5950205901582452, 0.5950167788874188, 0.5950075450767986, 0.5949886126664332, 0.5950529394813573, 0.5949972887301032, 0.5949430323462245, 0.5949624915175985, 0.5949857619597988, 0.5949025956923344, 0.5950559451177001, 0.5950508634232649, 0.5950492831402393, 0.5950499028590729, 0.5950170267749522, 0.595028119742073, 0.5949438689666499, 0.5950107366287916, 0.5949871253412327, 0.5949859788613906, 0.5950010380290462, 0.5949880239335413, 0.5950471141243218, 0.5950338211553419, 0.5950503056763147, 0.5950107366287916, 0.5949067478085193, 0.5950065845126067, 0.5950213338208454, 0.5951158409429642, 0.5950705085102889, 0.5950483225760472, 0.5949658689852414, 0.5949676661698587, 0.5950539620174327, 0.5949546830602955, 0.5949904098510506, 0.5950073591611486, 0.5950426831346618, 0.5950656747033871, 0.5950526606078822, 0.5950305986174073, 0.5949974126738699, 0.5949928887263849, 0.5950203112847701, 0.5950615845590855]
adam_tolstoi_l = [0.0005577469502086903, 0.15867339887892862, 0.2769958199964676, 0.34864538758765146, 0.39926433177267473, 0.4361270051777509, 0.4645138460680389, 0.48099911070347384, 0.49088424581767254, 0.4996806898710055, 0.5091921965004478, 0.514243307811246, 0.5204394736108228, 0.5242028091854726, 0.5288805089131061, 0.532391804838145, 0.5364483603788961, 0.5393737431327407, 0.5422591540218203, 0.5438028426502896, 0.5467949381365674, 0.548483640972091, 0.5501504367468479, 0.5520843003529299, 0.5541707077498939, 0.554683246211194, 0.5566847831139012, 0.5584121564046393, 0.559341641697162, 0.5607382400604846, 0.5612281277984179, 0.5622852131987717, 0.5642196965236872, 0.5648949731506815, 0.5658140471668004, 0.5661509573106681, 0.5673485949424746, 0.5681041561443573, 0.5685289424188246, 0.569224824697035, 0.5699305295187573, 0.5715425111626855, 0.5718883452577566, 0.5717733254422469, 0.5730901350057479, 0.5732220111735306, 0.5737357890724978, 0.5743504881835111, 0.5751790522639878, 0.5762007517189451, 0.5761690531006083, 0.5767537268341354, 0.5770312369278059, 0.576862394531601, 0.5770602707551584, 0.5780335081973309, 0.5784882888633427, 0.5793494191685232, 0.5796578842179303, 0.5796207630597998, 0.5806785921227539, 0.581102913608096, 0.5807470090819795, 0.5806925048105674, 0.5813717786240383, 0.5814027645657165, 0.5819967650676888, 0.5826987205904681, 0.5823107456147146, 0.5828434249381056, 0.5826172895357377, 0.5833780253898806, 0.58325634359691, 0.583815701816086, 0.5845405249638239, 0.5847646462799828, 0.5848403759214444, 0.5851309001106199, 0.585284404465694, 0.5852423255568948, 0.5861662953517989, 0.586281563054842, 0.586748180350575, 0.5862419940073189, 0.5869207410597812, 0.5860980643082233, 0.5870806595047827, 0.5872411666826761, 0.5871416088520638, 0.5875941585302749, 0.5879321221961596, 0.5881429195573968, 0.5879936602763326, 0.5883470549411732, 0.5884718973001949, 0.5888619793199825, 0.5882628351516916, 0.5888586638242229, 0.5887852581283871, 0.5889174751415283, 0.5890084808522373, 0.5895770418960917, 0.5900137577581052, 0.5896628109826572, 0.590000774648542, 0.58957220808919, 0.5898222026666501, 0.5902655805061243, 0.5904684764522337, 0.5904225552866664, 0.5908173471695891, 0.5902818171395637, 0.5909182064097519, 0.5907779640377161, 0.5910078797249688, 0.5912261137122088, 0.5912743278374601, 0.5912627390952725, 0.5915438745441194, 0.5916297365885098, 0.5917570268369241, 0.5918754241200768, 0.5917861846080433, 0.5923679766489943, 0.5920632608985303, 0.5922345511841277, 0.5920525397627097, 0.5921791173344654, 0.5921245820771116, 0.5923076780064884, 0.5920923566977663, 0.5928358023964527, 0.5924901542170318, 0.5927460051374691, 0.5930872533131718, 0.5928660446755307, 0.5932800168563522, 0.5932362956926442, 0.5931586139368569, 0.5932497126053909, 0.5933469464903773, 0.5932144196178194, 0.5939536512284377, 0.5941122992498303, 0.5940305893216248, 0.5942845191136781, 0.5943615191787486, 0.594349248745844, 0.5944763530786082, 0.5943507360710446, 0.5946448236435129, 0.5946627645037447, 0.5944865164674787, 0.5945078967672367, 0.5944256910639643, 0.5946607504175355, 0.5944564291181091, 0.5945698686505932, 0.5945911250065845, 0.5946192292556867, 0.5945505024370443, 0.5947213589194582, 0.5946614011223108, 0.5944651361677207, 0.5946838349440858, 0.5945461334192677, 0.5949660549008915, 0.5946461560390051, 0.5947431420364581, 0.5948554350891001, 0.5947144180685223, 0.5949842746345982, 0.5948530181856492, 0.5947782181224378, 0.594786491368866, 0.5947099560929207, 0.594677172966625, 0.5948655055201455, 0.5947933082760352, 0.5948366885943848, 0.5947265955436019, 0.5948305843638741, 0.5949980633786451, 0.59486392523712, 0.594891843570572, 0.5948734069352735, 0.5947625392359487, 0.5948001251832044, 0.5949113027419459, 0.5950059028218897, 0.5951632184477902, 0.5948609815726604, 0.5949904098510506, 0.5949293365600027, 0.5950336042537501, 0.5950969705044821, 0.5951609564740478, 0.5950553563848082, 0.5951093648811534, 0.5950190408611613, 0.5949387253003312, 0.595081570491468, 0.5950585169508594, 0.5950107056428499, 0.594880378772151, 0.594862375940036, 0.5949296464194195, 0.5949004886483003, 0.5949532577069784, 0.5949991788725455, 0.5950336972115751, 0.5950134014197759, 0.595235756537259, 0.5951861170586905, 0.5952334945635165, 0.595273032625098, 0.5953207819612242, 0.5952626213486941, 0.5951778128263207, 0.595194638192652, 0.5953083256126696, 0.5953017875789754, 0.5952421396412447, 0.5952463847152547, 0.5952276692064811, 0.5952127959544754, 0.5951829255066976, 0.5951771931074872, 0.5951866128337573, 0.5952400325972107, 0.5951997198870872, 0.5952071255271484, 0.5952356325934923, 0.5951359508191134, 0.5951852184663818, 0.5951768522621287, 0.5952196128616447, 0.5951969001663945, 0.5952544720460328, 0.5952575396542589, 0.5952549678210995, 0.5952183114520941, 0.5952206044117784, 0.5951515367477775, 0.5952062579207813, 0.5952404044285108, 0.5952792298134336, 0.5952031283406718, 0.595177688882554, 0.5951828015629309, 0.5951456804048003, 0.5951900212873419, 0.595255401624283, 0.5952048945393476, 0.5951782776154458, 0.5951792071936962, 0.5952247565279633, 0.5952422016131281, 0.5951989452385452, 0.5952592748669928, 0.5952605452906017, 0.5952432861210869, 0.595203407214147, 0.595248181899872, 0.5952914692603966, 0.5952140663780843, 0.5952047705955807, 0.5952361283685592, 0.595244525558754, 0.59518462973349, 0.595213229757659, 0.5951682691562838, 0.595201857917063, 0.5952402804847441, 0.5951878212854828, 0.5952166072253019, 0.595255401624283, 0.5952354156919006]
target_C100_l=[0.0094, 0.2244, 0.3578, 0.4484, 0.5095, 0.5809, 0.602, 0.621, 0.6269, 0.6456, 0.6585, 0.6728, 0.6751, 0.6758, 0.6778, 0.6801, 0.6838, 0.6842, 0.6836, 0.6872, 0.6805, 0.6883, 0.6876, 0.6979, 0.696, 0.6954, 0.699, 0.6901, 0.6936, 0.7001, 0.6966, 0.7062, 0.7021, 0.7018, 0.7012, 0.7099, 0.7032, 0.6945, 0.6996, 0.7022, 0.7042]
mars_l=[0.01, 0.2442, 0.3982, 0.5066, 0.5496, 0.5912, 0.6105, 0.625, 0.6437, 0.6613, 0.6656, 0.665, 0.6749, 0.6762, 0.6857, 0.6881, 0.6893, 0.6852, 0.6819, 0.6941, 0.6942, 0.6947, 0.6904, 0.6961, 0.6965, 0.6953, 0.703, 0.6992, 0.6948, 0.6987, 0.7014, 0.693, 0.7034, 0.7104, 0.6909, 0.6992, 0.6945, 0.6989, 0.7015, 0.7231, 0.7281, 0.7281, 0.7307, 0.733, 0.7326, 0.734, 0.7355, 0.7346, 0.7357, 0.7322, 0.7345, 0.7345, 0.7363, 0.7363, 0.7344, 0.7324, 0.737, 0.7364, 0.7366, 0.735, 0.7351, 0.7352, 0.7366, 0.7364, 0.7366, 0.7369, 0.7386, 0.738, 0.7371, 0.7365, 0.736, 0.7356, 0.7367, 0.7368, 0.7363, 0.7375]
new_target_C = [0.006, 0.2961, 0.4705, 0.4869, 0.568, 0.5879, 0.6246, 0.6046, 0.631, 0.6538, 0.6671, 0.6733, 0.6714, 0.6643, 0.679, 0.6879, 0.6882, 0.6855, 0.6821, 0.695, 0.6883, 0.727, 0.7316, 0.7344, 0.7316, 0.7328, 0.7335, 0.7341, 0.7323, 0.7321, 0.7355, 0.7364, 0.736, 0.7363, 0.7374, 0.7373, 0.7367, 0.7357, 0.7355, 0.7357, 0.7378]
mnist_1 = [0.1389, 0.9301, 0.9543, 0.9654, 0.9694, 0.9741, 0.9769, 0.9749, 0.9787, 0.9782, 0.9792, 0.9777, 0.9805, 0.9805, 0.9815, 0.9815, 0.9816, 0.9814, 0.9813, 0.9818, 0.9819, 0.9813, 0.9815, 0.9815, 0.9819, 0.9813, 0.9815]
mnist_2 = [0.08, 0.9282, 0.9535, 0.9643, 0.9683, 0.9717, 0.975, 0.9736, 0.9767, 0.9762, 0.9784, 0.977, 0.979, 0.9763, 0.9796, 0.9795, 0.9794, 0.98, 0.9794, 0.9799, 0.9802, 0.9799, 0.9798, 0.9797, 0.9798, 0.9799, 0.9797]
mnist_3 = [0.0739, 0.929, 0.9516, 0.9617, 0.9673, 0.971, 0.9744, 0.9729, 0.9766, 0.9762, 0.9772, 0.9765, 0.9789, 0.9785, 0.9777, 0.9789, 0.9793, 0.9784, 0.9783, 0.9782, 0.9787, 0.9787, 0.9784, 0.9789, 0.9789, 0.979, 0.9791]
mnist_4 = [0.0671, 0.9295, 0.952, 0.9641, 0.9677, 0.9718, 0.9741, 0.9728, 0.9767, 0.9756, 0.9772, 0.9762, 0.978, 0.9785, 0.9783, 0.979, 0.9782, 0.979, 0.9793, 0.9794, 0.9792, 0.9795, 0.9797, 0.979, 0.9789, 0.9791, 0.9791]
shampoo_mnist_1 = [0.081, 0.9757, 0.9776, 0.9769, 0.9805, 0.9731, 0.9759, 0.9773, 0.9743, 0.9724, 0.9792]
shampoo_mnist_10 = [0.081, 0.9653, 0.9688, 0.9667, 0.9732, 0.9736, 0.9744, 0.9714, 0.9762, 0.979, 0.9787, 0.9747, 0.9765, 0.9779, 0.9775, 0.9716, 0.9767, 0.9761, 0.9762, 0.9783, 0.9776, 0.972, 0.9762, 0.9789, 0.978, 0.9789, 0.9817, 0.9758, 0.9736, 0.9713, 0.9761, 0.9789, 0.9793]
shampoo_mnist_100 = [0.081, 0.9705, 0.9734, 0.9722, 0.9743, 0.9716, 0.977, 0.9755, 0.9752, 0.9767, 0.9779, 0.9784, 0.974, 0.9809, 0.9772, 0.9783, 0.9786, 0.9792, 0.9778, 0.9798, 0.9786, 0.9771, 0.9782, 0.9787, 0.9784, 0.9792, 0.9814, 0.9723, 0.981, 0.9782]
shampoo_mnist_101 = [0.081, 0.9741, 0.9746, 0.9717, 0.9752, 0.9767, 0.9746, 0.9718, 0.9753, 0.9761, 0.9763, 0.9763, 0.9764, 0.9725, 0.9763, 0.9769, 0.9773, 0.9781, 0.9789, 0.9776, 0.9789, 0.9783, 0.9779, 0.9786, 0.9794, 0.9768, 0.9769, 0.9773, 0.9787, 0.9786]

#plt.plot(range(len(mnist_1)), mnist_1, label='mars_AdamW, step LR')
#plt.plot(range(len(mnist_2)), mnist_2, label='AdamW, step LR')
#plt.plot(range(len(mnist_3)), mnist_3, label='AdamW, using search space')
plt.plot(range(len(mnist_4)), mnist_4, label='AdamW, Algoperf params')
plt.plot(range(len(shampoo_mnist_1)), shampoo_mnist_1, label='Shampoo, precond. freq = 1')
plt.plot(range(len(shampoo_mnist_10)), shampoo_mnist_10, label= 'Shampoo, precond. freq = 10')
plt.plot(range(len(shampoo_mnist_100)), shampoo_mnist_100, label= 'Shampoo, precond. freq = 100')
plt.ylim([0.95,0.99])
plt.title("MNIST 480s runtime limit, 5 trials")
plt.xlabel('Steps (x1000)')
plt.ylabel('Test Accuracy')
plt.legend()

plt.savefig('utils', dpi=500)







