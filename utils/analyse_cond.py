import matplotlib.pyplot as plt
plt.rcParams['font.size'] = 13
plt.rcParams['font.family'] = 'serif'

true_1 = [1228.5737787090454, 12208.339530696001, 6401.820726994299, 9054.243999425886, 11354.054188867582, 6848.489951505696, 5905.1078678635995, 9598.939326339549, 4662.290018152807, 13557.894718005613, 9935.096541531027, 7704.734484581033, 8578.30620583851, 13344.668878995286, 18083.347738857603, 7427.234100897432, 5048.328651968062, 9134.192074074495, 9252.731806532152, 8313.20195905562, 8675.778332741496, 4604.466709126786, 6753.68021431566, 14203.339564896889, 7524.138471816084, 12950.536769442162, 7104.663656515561]
true_100 = [783.7952657848768, 12441.428324630157, 10453.64459498318, 10609.952101233002, 10445.266252995503, 11127.375600170746, 12301.051630011676]
lanczos_500 = [416.9725582745317, 6561.151931166447, 4694.397510005269, 7468.218668248591, 6405.2299254808895, 5824.472588995662, 3409.9211146702314, 6001.289206498502, 7057.171385803557, 8802.255900731161, 5225.3583234466905, 4674.549178842614, 7177.288777706154, 7104.80368328498, 9518.46509062628, 5087.4089330618, 3070.998652882343, 10444.238401857423, 3697.4318736958635, 6554.226928344484, 6055.65974634543, 8100.4574473765915, 5068.258747581069, 5616.586291842984, 3706.322298945867, 5612.733895715789, 3359.899978426212]

SVHN_approx = [132.35786037547652, 92.25531292397835, 103.2187338673068, 98.15333742706594, 119.63411806243091]
SVHN_true = [159.6430725654096, 83.46791016525349, 79.19276075650535, 87.1141772952359, 77.2666426737244]

SVHN_long_approx = [2450.761452116044, 6014.397998187221, 3678.8583277778207, 4854.252082526427, 5168.285748958072, 4296.712567848611, 3763.074158568909, 1047147.0544732638, 77289.73963995998, 189519.96300487834, 164541.11525457032, 106235.90918592545, 826067.6108386089, 20372.669985300447, 26243.0791339846, 134675.63487625105, 749472.2617431047, 85764.35089162258, 60142.07776611671, 806069.2841206918, 44485.13267286067, 82502.3663920105, 38161.979712351495, 22469.431417332296, 939309.1998300442, 321841.41914489644, 53584.17160212813]
SVHN_long_true = [1e7, 1e7, 1e7, 3418123.869575871, 7190715.724607938, 7960564.405456112, 12726839.160580613, 10992125.345208319, 11208236.676613059, 9856969.001056563, 6670458.646718439, 7922653.076912577, 6532728.736825969, 5814252.061703991, 6783660.143275634, 5596561.084810926, 5993124.511318104, 7492999.008049268, 3579346.4341803268, 4917388.221233017, 4088159.765789047, 3928645.273333124, 4958723.343388475, 6136519.236875767, 6040473.105781403, 5669471.041248685, 5087867.561212926]


MNIST_50_true = [1082.896551594429, 16164.194705506838, 11384.247516355257, 14097.700338931021, 6823.242940657765, 7883.679202239323, 12103.047794528586, 8520.299515055085, 8619.728343670413, 8027.987971613807, 10405.06767064464, 11524.358712545225, 7392.4542506941025, 9795.539399680234, 7887.160428511114, 9831.969855125108, 24083.107442922017, 12785.865012519831, 8114.57351622989, 9603.718801911738, 10408.165469119, 8714.985022418152, 5836.071908330095, 14382.050139113138, 9599.747773838837, 9835.07280203466, 7488.61340101579]

MNIST = [648.5951017144515, 7421.495723267465, 3659.294496876358, 5307.129030308003, 4235.199096023605, 6072.316186123621, 2287.685975052684, 1493.42315883451, 3300.1840248609856, 4437.37554107796, 19062.298513665133, 4854.799502161564, 8731.889936684924, 7275.096258622785, 5552.74493592544, 612.2647519516472, 1074.0785083326666, 977.1483187423408, 3091.4381755194404, 216.8376606482603, 391.83607741213723, 1030.4316079818902, 459.82163482306066, 316.3379899238483, 235.58168516502244, 768.7719484658478, 1269.2887107711838]
SVHN = [3361.5610507350725, 9648.964362592034, 22786.020058328177, 67140.952372496, 45608.02110289257, 23355.54623070291, 15235.15389837408, 12950.38671780756, 11403.724533941584, 9866.135342631596, 24610.97251262572, 9864.236912324564, 14041.424307323274, 7973.6920750621275, 9320.750643697547, 9298.356810611618, 21639.049927037682, 13353.384703870019, 8862.273432069736, 15148.814207602296, 11150.093714583933, 9480.132133670844, 10720.38532522201, 8985.039548754114, 15559.278602510669, 19111.333752527727, 14725.990448756635]
Tolstoi = [5025.516483687644, 20892.369445328375, 15449.414211401618, 11193.972860299802, 10284.350608133733, 12960.980835203982, 8146.162653299417, 10716.82886799231, 9133.253193955561, 9847.711042815648, 11739.296973576227, 9219.087704423502, 13598.328655571173, 8684.007156807042, 12520.395960228632, 10204.645950476133, 17426.52016763445, 9420.257779830074, 15854.903550477864, 8618.686815299337, 12304.394740872503, 10262.239064914567, 11939.291733784665, 14877.40099388091, 9130.33509165239, 13185.177963338856, 13988.760704771317]
CIFAR_10_wide = [1149.587048129136, 4961.960979831156, 2668.8070408880035, 2968.292717186178, 2149.5017238742394, 2217.5231699865917, 1784.2088237018288, 3976.458821404218, 2337.0227986520363, 2442.917703772793, 3245.622105802072, 2289.719241839963, 3471.0500958804882, 2487.6566263746936, 2505.6209337665655, 2599.404232079915, 2972.0137888797344, 2879.1979474027526, 4085.3262668059865, 2772.8382831739113, 3984.2160288273158, 6191.135736754075, 4324.5399585029545, 4521.064809121166, 6529.9808904339525, 4546.102525984121, 3973.3914681617775, 3990.729839113281, 5202.238268698972, 4820.18434091701, 5209.0243037403425, 5447.740909044203, 7969.179562361741, 6487.006026979713, 9091.654908458095, 6771.159806542208, 15706.784829827791, 10449.997587303345, 16508.73733487492, 8223.997360427093, 9834.947849984375, 14091.214359664575, 11113.540243945683, 9539.925118419327, 9478.38014454221, 11404.55416025682, 9289.75777353728, 12465.157329338295, 11708.435466754816, 25550.018181994714, 12402.640525452998, 8881.916846056363, 9155.627282559648, 12447.69588179164, 14281.65041138132, 22696.270385725238, 24845.977445058696, 28885.716606055128, 16411.593550940273, 20389.30710371892, 29274.082318315013, 20365.474748328033, 22983.91504495798, 15589.397266292277, 55704.35361578098, 23277.579930380347, 21402.22954318346, 18148.865601989164, 14048.669011885086, 20996.317485390166, 17112.487251613402, 24907.699735216807, 11608.023202653869, 40284.579828446855, 31898.994688545914, 16849.56532514468, 24327.454680417737, 12916.91840950249]
CIFAR_100 = [2100.4239688062726, 4921.640149025284, 2183.1004153398044, 1662.6178574661262, 1856.2433937145438, 2311.1809965269713, 2365.5265752352975, 2313.5950665844907, 2228.387140805736, 1669.7404820467116, 2464.380686020925, 3031.268868125174, 2728.9939766844063, 2489.3972096908574, 2597.8667408539645, 3951.12258194133, 4504.20176395751, 2938.5769711290204, 4522.265501451633, 4782.182889177375, 4037.5964735968478, 4260.148941397847, 5183.005172615365, 4954.510430942892, 5518.795707310488, 5218.351590800469, 6247.922518464765, 5085.683611814797, 8071.370432428527, 8294.996956109359, 7164.100481781362, 6809.637577406866, 7277.763383277183, 8644.15478860134, 6843.642295352468, 8470.39130585034, 6577.272565597498, 8811.465548605513, 10398.828986897124, 10436.805422204037, 13460.472419373065, 10530.945856733197, 12603.540940853429, 13453.419637369572, 17842.128595067643, 11073.258695062314, 18121.065455773667, 17141.37037264719, 16263.35010716474, 26395.497824114977, 12071.769646876348, 32089.006847125194, 18403.87938156687, 22765.797047613305, 17612.307692203824, 9952.998972717975, 28496.008178391756, 30494.51631439889, 34472.53616401422, 29407.165005702067, 30412.159531429435, 28565.235184915513, 27708.645752280114, 33956.60440489228, 16240.141273498148, 16339.139569467372, 14655.465215697592, 15774.677206442964, 22839.95982064416, 16200.236003368935, 13666.504388964962, 23603.45702669867, 18222.364646425474, 14368.109950466009, 12574.973076935768, 24387.88227863863, 18587.910739261053, 26505.219579920136]

"""
# MNIST_less_params
plt.semilogy(range(len(true_1)),true_1, label="True, 1 sample MNIST")
#plt.semilogy(range(len(true_100)),true_100, label="True, 100 Samples")
plt.semilogy(range(len(lanczos_500)),lanczos_500, label="Lanczos, 1 Sample MNIST")

# SVHN_less_params
plt.semilogy(range(len(SVHN_long_true)),SVHN_long_true, label="True, 1 sample SVHN")
plt.semilogy(range(len(SVHN_long_approx)),SVHN_long_approx, label="Lanczos, 1 Sample SVHN")

"""
plt.semilogy(range(len(MNIST)),MNIST, label="MNIST MLP")
plt.semilogy(range(len(SVHN)),SVHN, label="SVHN Deep-CNN")
plt.semilogy(range(len(Tolstoi)),Tolstoi, label="Tolstoi RNN")
plt.semilogy(range(len(CIFAR_10_wide)),CIFAR_10_wide, label="CIFAR10 Wide-ResNET")
plt.semilogy(range(len(CIFAR_100)),CIFAR_100, label="CIFAR100 ResNET")


plt.ylabel("Condition Number")
plt.xlabel("Steps (x1000)")
plt.legend()
plt.savefig("compare_condition_numbers.png", dpi=500)

