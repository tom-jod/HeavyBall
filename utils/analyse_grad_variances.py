import matplotlib.pyplot as plt
import numpy as np

plt.rcParams['font.size'] = 10
plt.rcParams['font.family'] = 'serif'
true = [2.1217172161414055e-06, 7.37819345886237e-06, 5.159206921234727e-06, 4.8378419705841225e-06, 4.367280325823231e-06, 3.721849680005107e-06, 3.4156287256337237e-06, 6.248621502891183e-06, 2.6410796181153273e-06, 1.340706376140588e-06, 9.460069918532099e-07, 5.463332968247414e-07, 4.352585847300361e-07, 2.741389550919848e-07, 1.8806015589234448e-07, 2.1242883008198987e-07, 4.659249697169798e-08, 6.216674819370382e-08, 1.6902587773870437e-08, 1.3413142596618854e-08, 1.4523022784374007e-08, 7.511642863278212e-09, 7.68473906731515e-09, 6.208733527302002e-09, 5.247639656147385e-09, 5.077402942532672e-09, 5.064520358644131e-09]
ten = [2.0394381863297895e-06, 6.893684258102439e-06, 3.157915898555075e-06, 2.7070311716670403e-06, 3.3412184166081715e-06, 2.83457052319136e-06, 3.829022716672625e-06, 1.4243797750168596e-06, 1.4628717508458067e-06, 1.1994511623925064e-06, 2.4022912725740753e-07, 3.0539126782969106e-07, 2.545455970448529e-07, 3.830317041320086e-08, 3.657551417290961e-08, 5.427005067559776e-09, 9.860431582353613e-09, 2.3585670305692474e-08, 2.556815559273673e-08, 4.910698514493106e-09, 7.250392730639987e-09, 3.6394398605921197e-09, 4.266424991072881e-09, 5.130067037839581e-09, 8.213032032244882e-09, 6.1242624305180016e-09, 1.2500100510237644e-08]
five = [1.3120610447003855e-06, 1.1018430086551234e-05, 4.657352292269934e-06, 2.700194954741164e-06, 2.7792550554295303e-06, 2.6822588097275e-06, 1.4254617326514563e-06, 9.330304919785704e-07, 5.580890274359263e-07, 1.6047771396188182e-06, 1.0258109739424981e-07, 6.303084632008904e-08, 6.483433168114061e-08, 2.1890411261438203e-08, 3.314717744729023e-08, 1.3214402905248335e-08, 1.0897686308908305e-08, 4.869141978502967e-09, 1.1742244510060118e-08, 5.1616231289131065e-09, 6.377968375659293e-09, 8.993995770367746e-09, 2.190223291620441e-08, 4.352474824997898e-09, 2.3323301068245428e-09, 7.961053150040698e-09, 4.521262031431661e-09]
twenty = [1.9721737771760672e-06, 7.23418179404689e-06, 6.382463652698789e-06, 4.423337486514356e-06, 4.229138994560344e-06, 2.684159881027881e-06, 1.4835155752734863e-06, 1.7366838847010513e-06, 1.3487791648003622e-06, 1.0198323252552655e-06, 7.760016274005466e-07, 3.04714404819606e-07, 6.934765792721009e-07, 1.4479970111835883e-08, 4.24400283804971e-08, 2.8982897859464174e-08, 1.9364888359518773e-08, 7.480263519710206e-09, 3.0764255143367336e-08, 4.582505930272873e-09, 4.181208712594753e-09, 1.3620244487810851e-08, 5.592227125816862e-09, 4.9973154503391015e-09, 3.9653484940060935e-09, 3.931516001642876e-09, 3.72202957343859e-09]
fifty = [1.6423792885689181e-06, 8.296990927192383e-06, 6.060570740373805e-06, 3.7216298096609535e-06, 4.94970845466014e-06, 4.449807875062106e-06, 3.5860484786098823e-06, 2.888456037908327e-06, 2.910038574555074e-06, 1.3243379726191051e-06, 1.1008045248672715e-06, 5.229664452599536e-07, 1.1943948265979998e-06, 1.777208069597691e-07, 1.9465993261746917e-07, 2.804223697694397e-07, 4.439876732931225e-08, 8.607130297377807e-08, 4.5440074813996034e-08, 1.704862384599437e-08, 2.517659680734141e-08, 1.1061573879089792e-08, 8.898625836195606e-09, 1.0799213079337733e-08, 4.5477124288595405e-09, 6.0421960768053395e-09, 7.155068981745671e-09]
fivehundred = [2.103806309605716e-06, 6.8372728492249735e-06, 5.0162384468421806e-06, 4.005049504485214e-06, 4.0181776057579555e-06, 4.272681962902425e-06, 2.640412049004226e-06, 3.6469295991992112e-06, 3.5178702546545537e-06, 1.896816911539645e-06, 1.9647554836410563e-06, 5.167810286366148e-07, 4.624701261946029e-07, 2.264503251581118e-07, 3.786331603805593e-07, 2.3929788994792034e-07, 2.164827037631767e-07, 2.7463952889661414e-08, 3.7701841648640766e-08, 2.4471187742847178e-08, 1.5859084712133154e-08, 1.4075870247154398e-08, 8.550364860582249e-09, 8.036221466056759e-09, 7.46577022425754e-09, 7.074288266295525e-09, 6.8344445658397035e-09]

MNIST = [2.016000962612452e-06, 7.351318345172331e-06, 5.554922609007917e-06, 4.797378551302245e-06, 3.942524472222431e-06, 4.352619725978002e-06, 4.953618372383062e-06, 5.950232662144117e-06, 2.3400293684971984e-06, 1.7182483134092763e-06, 1.0975529676215956e-06, 9.153076234724722e-07, 3.3914685104718956e-07, 3.9405296092809294e-07, 3.2049334208750224e-07, 1.867405075017814e-07, 1.0286598950415282e-07, 7.651588873613946e-08, 2.484796013391133e-08, 1.8780836441578685e-08, 1.634643709280681e-08, 1.0683654849685809e-08, 8.279048557824353e-09, 7.404041379999171e-09, 5.721187967822061e-09, 5.4512012681584565e-09, 5.44233413890538e-09]
SVHN = [8.423070596563775e-08, 2.441746005388268e-07, 2.3229467842611484e-06, 6.395664968295023e-05, 7.841273327358067e-05, 9.433789091417566e-05, 7.579478551633656e-05, 6.372846110025421e-05, 4.320843436289579e-05, 4.533297396847047e-05, 3.4905569918919355e-05, 3.4725326258921996e-05, 5.033676279708743e-05, 3.148262112517841e-05, 3.532346818246879e-05, 4.021757558803074e-05, 3.7552250432781875e-05, 4.054300734424032e-05, 3.2312153052771464e-05, 3.015293987118639e-05, 4.02767545892857e-05, 3.693363760248758e-05, 3.595720409066416e-05, 3.392538565094583e-05, 3.426114926696755e-05, 3.353368811076507e-05, 3.3127464121207595e-05]
Tolstoi = [2.4913222596012474e-09, 1.1165278834823766e-07, 1.7894346626690094e-07, 2.1640862257754634e-07, 2.3322822073623684e-07, 2.491000827831158e-07, 2.593464500932896e-07, 2.6502831929064996e-07, 2.6789254548020836e-07, 2.7433239324636816e-07, 2.764286364254076e-07, 2.818298412421427e-07, 2.81269024071662e-07, 2.8276252805881086e-07, 2.8529163387247536e-07, 2.832420022969018e-07, 2.8507886895567935e-07, 2.866487989194866e-07, 2.8844743837908027e-07, 2.8861879286523617e-07, 2.8830581300098856e-07, 2.8941991558895097e-07, 2.905787255258474e-07, 2.9027157211203303e-07, 2.911280319040088e-07, 2.914204912940477e-07, 2.915931531788374e-07]
CIFAR10_wide = [3.1440563930118515e-07, 9.42560632211098e-07, 6.185028382788005e-07, 5.534988076760783e-07, 4.973064164914831e-07, 5.523080517377821e-07, 4.5120486902305856e-07, 4.4353359385240765e-07, 5.23324047208007e-07, 5.031945420341799e-07, 5.501000259755529e-07, 5.262969580144272e-07, 5.360645900509553e-07, 5.898096446799173e-07, 5.732620138587663e-07, 6.732732913405926e-07, 6.549533964061993e-07, 7.453106718458002e-07, 7.948236202537373e-07, 9.951106676453492e-07, 9.892258958643652e-07, 9.011880592879606e-07, 1.038226400851272e-06, 1.0611632887957967e-06, 1.0636022125254385e-06, 1.0521953299758025e-06, 1.0992636134687928e-06, 1.176198907160142e-06, 1.032269324241497e-06, 1.3099810303174309e-06, 1.2259383765922394e-06, 1.271141059078218e-06, 1.1037742524422356e-06, 1.2147992265454377e-06, 1.351755145151401e-06, 1.2594656482178834e-06, 1.2821933523810003e-06, 1.2348214113444556e-06, 1.229452209372539e-06, 1.2080321312168962e-06, 1.355767039967759e-06, 1.2397212003634195e-06, 1.351192736365192e-06, 1.4312089433587971e-06, 1.3169945987101528e-06, 1.3340544455786585e-06, 1.2016449773000204e-06, 1.3063817050351645e-06, 1.3226275541455834e-06, 1.415203314536484e-06, 1.3746619060839294e-06, 1.3545576393880765e-06, 1.2940988654008834e-06, 1.400752353220014e-06, 1.2926859653816791e-06, 1.18809668947506e-06, 1.1194174476258922e-06, 1.2316920674493304e-06, 1.1252240028625238e-06, 1.2891015330751543e-06, 1.002433009489323e-06, 9.464736763220571e-07, 8.676531138007704e-07, 8.716168053979345e-07, 8.153113526532252e-07, 8.263863833235519e-07, 7.205732117654406e-07, 7.41538940474129e-07, 6.525535809487337e-07, 6.136786510069214e-07, 6.678290560557798e-07, 6.024894787515223e-07, 6.141573862805672e-07, 5.565365199799999e-07, 5.604519515145512e-07, 4.97021403589315e-07, 5.343447355699027e-07, 5.195473704588949e-07]
CIFAR100 = [4.688272838393459e-06, 2.2641977466264507e-06, 1.5210030142043252e-06, 1.3574151580542093e-06, 1.336908439952822e-06, 1.2466048247006256e-06, 1.3143426258466206e-06, 1.2403344271660899e-06, 1.35539175971644e-06, 1.325188236478425e-06, 1.4266855714595295e-06, 1.4692004697280936e-06, 1.6044356243583024e-06, 1.7073358549168915e-06, 1.8653902316145832e-06, 1.8862856450141408e-06, 1.997644631046569e-06, 2.1412627120298566e-06, 2.366394710406894e-06, 2.5253880266973283e-06, 2.5266947432101006e-06, 2.711905381147517e-06, 2.6949010134558193e-06, 2.800044285322656e-06, 2.900562094509951e-06, 3.067081252083881e-06, 3.1582305837218883e-06, 3.105534005953814e-06, 3.404260041861562e-06, 3.2525003916816786e-06, 3.4250665521540213e-06, 3.319094957987545e-06, 3.3276087378908414e-06, 3.5425664464128204e-06, 3.6228382214176236e-06, 3.7590282317978563e-06, 3.680036343212123e-06, 3.50142454408342e-06, 3.6497142446023645e-06, 3.5893460790248355e-06, 3.6887199712509755e-06, 3.7686243103962624e-06, 3.8133821362862363e-06, 3.591462473195861e-06, 3.951834059989778e-06, 3.680805775729823e-06, 3.5501952879712917e-06, 3.409243163332576e-06, 3.3911830996657955e-06, 3.3330875339743216e-06, 3.6728517898154678e-06, 3.32261151925195e-06, 3.3516244002385065e-06, 3.2947102681646356e-06, 2.9744360290351324e-06, 2.932989900727989e-06, 2.8849101454397896e-06, 2.654573563631857e-06, 2.583030436653644e-06, 2.6626796625350835e-06, 2.277333123856806e-06, 2.1682553779101e-06, 2.2655474367638817e-06, 2.0164850411674706e-06, 1.927749281094293e-06, 1.8211665064882254e-06, 1.7627519355301047e-06, 1.648571242185426e-06, 1.4735245486008353e-06, 1.4792125284657232e-06, 1.5516075109189842e-06, 1.449571868761268e-06, 1.4175092246659915e-06, 1.259757368643477e-06, 1.1939433761654072e-06, 1.2755532452501939e-06, 1.323583319390309e-06, 1.2497525858634617e-06]


CIFAR100_n = [52.05611038208008, 51.68265151977539, 61.44646072387695, 60.09184265136719, 49.6096305847168, 43.04046630859375, 42.261051177978516, 40.14726638793945, 41.72893524169922, 40.52005386352539, 42.96952819824219, 44.228515625, 45.96077346801758, 49.6119270324707, 54.185611724853516, 55.81826400756836, 58.847740173339844, 63.439544677734375, 68.08069610595703, 73.72591400146484, 80.46272277832031, 86.21161651611328, 90.4227523803711, 100.1921157836914, 105.98104095458984, 116.20409393310547, 118.16670989990234, 128.7168426513672, 136.16651916503906, 135.839599609375, 151.36083984375, 158.74612426757812, 163.2427215576172, 172.81922912597656, 173.57470703125, 181.77809143066406, 190.124755859375, 192.65203857421875, 209.1897735595703, 213.7644805908203, 212.70196533203125, 223.399658203125, 221.49276733398438, 213.7992401123047, 222.41973876953125, 223.65321350097656, 231.5583038330078, 237.4443359375, 239.29493713378906, 236.49826049804688, 240.56134033203125, 228.6750946044922, 205.43821716308594, 223.22747802734375, 210.82972717285156, 204.70040893554688, 201.19252014160156, 191.99900817871094, 186.42794799804688, 188.17431640625, 180.32891845703125, 172.47006225585938, 164.9738311767578, 156.9653778076172, 152.78208923339844, 140.92047119140625, 138.08224487304688, 130.17684936523438, 124.77938079833984, 114.82752227783203, 112.78521728515625, 108.29779052734375, 114.6268081665039, 98.85913848876953, 102.23302459716797, 99.40897369384766, 100.31875610351562, 95.90695190429688]
CIFAR10_wide_n = [3.7658870220184326, 4.880433082580566, 1.4052927494049072, 0.693889319896698, 0.41546452045440674, 0.4171885550022125, 0.4343484044075012, 0.40004825592041016, 0.4520115852355957, 0.5717809200286865, 0.5731943249702454, 0.5840466022491455, 0.5995479226112366, 0.6236701607704163, 0.5777467489242554, 0.5732412338256836, 0.5452774167060852, 0.5889450311660767, 0.5641880631446838, 0.5954475402832031, 0.65337735414505, 0.6600508689880371, 0.6889400482177734, 0.5815934538841248, 0.718733549118042, 0.5511582493782043, 0.6396375298500061, 0.686326801776886, 0.637980043888092, 0.7705657482147217, 0.7187985181808472, 0.7397973537445068, 0.7923426032066345, 0.7583488821983337, 0.8263338804244995, 0.7831600308418274, 0.7792416214942932, 0.7971193790435791, 0.825068473815918, 0.8676949739456177, 0.8270394802093506, 0.8603066205978394, 0.9824929237365723, 0.9510558843612671, 0.9015406370162964, 0.9206352233886719, 0.8581973910331726, 1.0515475273132324, 0.9929520487785339, 1.0775011777877808, 0.9697129726409912, 0.9757195711135864, 1.2127858400344849, 1.0945864915847778, 1.0086463689804077, 0.9301995635032654, 0.9946821331977844, 0.9906653165817261, 1.0139269828796387, 1.007493019104004, 1.014556646347046, 0.7719795107841492, 0.73051917552948, 0.7562285661697388, 0.6446717381477356, 0.5902835130691528, 0.5441939234733582, 0.6128835678100586, 0.4942934811115265, 0.4757120609283447, 0.47144919633865356, 0.38244977593421936, 0.4308183789253235, 0.42564818263053894, 0.3342863917350769, 0.33980002999305725, 0.4189766049385071, 0.374724417924881]
MNIST_n = [0.22804096341133118, 0.7523034811019897, 0.45021697878837585, 0.5144185423851013, 0.46813079714775085, 0.35379892587661743, 0.3648298382759094, 0.36550173163414, 0.3510442078113556, 0.36623409390449524, 0.5294081568717957, 0.26130810379981995, 0.33843469619750977, 0.46174564957618713, 0.34802502393722534, 0.24506808817386627, 0.2631256580352783, 0.2674161493778229, 0.18794561922550201, 0.14447109401226044, 0.1511654108762741, 0.06937142461538315, 0.06445547193288803, 0.06357099860906601, 0.026440367102622986, 0.017624137923121452, 0.015992218628525734]
Tolstoi_n = [0.000721973367035389, 0.041239067912101746, 0.03827481344342232, 0.03501215949654579, 0.03244686499238014, 0.03190841153264046, 0.029690813273191452, 0.029777906835079193, 0.028512543067336082, 0.02799050323665142, 0.027922628447413445, 0.0283226128667593, 0.02794109284877777, 0.02760368399322033, 0.027122825384140015, 0.02724675089120865, 0.0276823528110981, 0.02799142524600029, 0.02803107351064682, 0.02806919999420643, 0.0281996913254261, 0.028049282729625702, 0.02817911095917225, 0.028484705835580826, 0.02854827418923378, 0.02852621115744114, 0.028576655313372612]
SVHN_n = [0.008429449051618576, 0.036414578557014465, 0.034984733909368515, 0.032805994153022766, 5.871289253234863, 11.134122848510742, 40.256961822509766, 37.470787048339844, 44.40251922607422, 36.36854934692383, 29.660425186157227, 17.508024215698242, 14.13369369506836, 11.67212200164795, 8.356118202209473, 8.460779190063477, 9.76628303527832, 10.749594688415527, 6.684730529785156, 7.581116199493408, 7.483274936676025, 12.031750679016113, 9.503541946411133, 6.120401382446289, 9.156210899353027, 7.275237083435059, 7.333486080169678, 9.020054817199707, 6.9326090812683105, 11.3633394241333, 8.591266632080078, 7.137136936187744, 6.053144454956055, 9.058345794677734, 8.164571762084961, 7.2084269523620605, 10.56197452545166, 8.261977195739746, 9.13127326965332, 9.146824836730957, 9.4542875289917, 8.237271308898926, 8.797911643981934, 9.500255584716797, 8.276418685913086, 9.24637508392334, 8.03166389465332, 11.230230331420898, 9.977569580078125, 16.19881820678711, 12.477118492126465, 13.549960136413574, 10.931954383850098, 19.099857330322266, 12.3154878616333, 10.920701026916504, 17.57377815246582, 12.611289978027344, 15.187353134155273, 10.795661926269531, 16.25523567199707, 13.038064002990723, 12.425268173217773, 11.98216438293457, 17.362689971923828, 13.323622703552246, 12.710646629333496, 14.334417343139648, 14.170890808105469, 13.985564231872559, 15.301875114440918, 14.727270126342773, 15.095541000366211, 14.784112930297852, 13.970438003540039, 13.747108459472656, 13.984400749206543, 13.934511184692383, 13.881614685058594, 13.89915657043457, 13.779236793518066, 13.354736328125, 13.335867881774902, 13.552838325500488, 13.372139930725098, 13.40501594543457]

CIFAR100_norm = [23.964170455932617, 7.605301856994629, 6.878084659576416, 8.652575492858887, 10.179876327514648, 8.533140182495117, 12.294046401977539, 11.386446952819824, 13.979025840759277, 12.61272144317627, 14.373793601989746, 20.185012817382812, 20.591934204101562, 25.053085327148438, 21.804828643798828, 18.348562240600586, 23.922834396362305, 22.362564086914062, 25.484506607055664, 25.75836944580078, 32.521400451660156, 22.006591796875, 10.025323867797852, 25.07455825805664, 29.71213722229004, 22.35763931274414, 21.750715255737305, 24.080047607421875, 22.101951599121094, 25.945327758789062, 26.335906982421875, 31.472919464111328, 34.29789733886719, 33.78281784057617, 35.816566467285156, 28.91566276550293, 34.26097869873047, 32.00381851196289, 43.057987213134766, 28.72467613220215, 38.98237228393555, 48.920921325683594, 52.4860725402832, 45.83161926269531, 50.94178009033203, 41.83107376098633, 51.884525299072266, 49.232975006103516, 57.89789962768555, 66.81793975830078, 75.6512680053711, 63.80113220214844, 73.21163940429688, 71.16046142578125, 83.2719497680664, 80.91616821289062, 85.93048858642578, 96.65232849121094, 111.91627502441406, 90.2666015625, 116.75418090820312, 137.1582794189453, 156.9156494140625, 173.74424743652344, 181.96351623535156, 175.35215759277344, 221.37701416015625, 201.7820587158203, 248.9327392578125, 293.0484924316406, 302.2325744628906, 296.3816833496094, 360.3280029296875, 384.9771728515625, 372.4050598144531, 400.28619384765625, 381.3454284667969, 404.58538818359375]
CIFAR10_wide_norm = [2.486375331878662, 3.7270712852478027, 4.14043664932251, 5.924225807189941, 8.789316177368164, 7.5420074462890625, 13.9628324508667, 10.195318222045898, 5.883658409118652, 7.9421000480651855, 10.666577339172363, 16.509836196899414, 8.080986022949219, 11.35981559753418, 11.121548652648926, 6.749696254730225, 13.636878967285156, 9.236001014709473, 12.207121849060059, 6.804970741271973, 16.509737014770508, 12.183294296264648, 10.825490951538086, 13.825981140136719, 13.291004180908203, 11.511648178100586, 17.221046447753906, 17.03188705444336, 16.79412269592285, 11.418420791625977, 9.244292259216309, 9.335871696472168, 20.208019256591797, 21.278133392333984, 18.903213500976562, 14.79185962677002, 15.963098526000977, 15.161609649658203, 16.901601791381836, 18.07171058654785, 25.502166748046875, 33.1550178527832, 12.246539115905762, 20.359607696533203, 20.18521499633789, 37.03374481201172, 25.1322078704834, 30.01088523864746, 41.3773307800293, 31.97670555114746, 30.735572814941406, 43.14986801147461, 29.597196578979492, 37.70722198486328, 34.74778366088867, 46.286434173583984, 27.481626510620117, 42.54836654663086, 62.811405181884766, 72.92718505859375, 83.46339416503906, 73.33191680908203, 140.9464874267578, 64.58650970458984, 166.5611572265625, 220.5868377685547, 191.84274291992188, 216.82229614257812, 258.83099365234375, 302.109130859375, 235.9236602783203, 265.23529052734375, 338.8524475097656, 403.26513671875, 329.3614196777344, 259.22833251953125, 418.2245178222656, 393.2409973144531]
MNIST_norm = [0.878977358341217, 5.082035064697266, 5.780595302581787, 5.327284336090088, 4.535579204559326, 3.7085304260253906, 6.270664691925049, 8.775299072265625, 9.355098724365234, 16.84341812133789, 7.30656099319458, 11.119370460510254, 4.4361491203308105, 6.17349100112915, 6.071002006530762, 11.154068946838379, 13.346002578735352, 16.789329528808594, 6.555394649505615, 3.7160143852233887, 10.591205596923828, 4.090251445770264, 4.448166847229004, 13.366043090820312, 9.379521369934082, 17.80604362487793, 5.965860843658447, 11.628508567810059]
Tolstoi_norm = [0.008559627458453178, 1.354649305343628, 4.686345100402832, 6.2352447509765625, 9.991534233093262, 14.752707481384277, 13.019789695739746, 13.436958312988281, 20.041561126708984, 13.30853271484375, 27.505619049072266, 19.90443992614746, 23.84721565246582, 32.91885757446289, 21.71184539794922, 31.727331161499023, 48.37704849243164, 47.4802131652832, 67.79572296142578, 91.3554458618164, 75.28565216064453, 124.37583923339844, 181.5771484375, 332.62481689453125, 311.33673095703125, 964.6242065429688, 1541.883544921875]
SVHN_norm = [0.4150935411453247, 10.85068130493164, 127.04156494140625, 31.978227615356445, 43.3964958190918, 18.197912216186523, 95.68863677978516, 37.610679626464844, 59.9196662902832, 60.57685089111328, 53.90736770629883, 37.54315185546875, 83.0577163696289, 94.8993148803711, 77.64482116699219, 45.50785827636719, 90.20901489257812, 32.893985748291016, 230.43353271484375, 39.779029846191406, 47.55968475341797, 27.735788345336914, 244.0419921875, 41.027130126953125, 44.96138000488281, 27.163536071777344, 122.33642578125, 50.948604583740234, 57.7907829284668, 27.895368576049805, 110.29436492919922, 52.392757415771484, 68.6027603149414, 41.141761779785156, 59.09483337402344, 41.346397399902344, 72.98785400390625, 86.44971466064453, 44.800357818603516, 37.23292541503906, 46.42280960083008, 124.5547866821289, 55.71718978881836, 44.84883499145508, 42.30365753173828, 92.5755844116211, 62.30583190917969, 84.07999420166016, 53.19676971435547, 120.33245086669922, 73.35549926757812, 194.5327911376953, 65.62922668457031, 237.2328643798828, 134.8251495361328, 344.1180419921875, 87.62383270263672, 341.7501525878906, 270.0820007324219, 426.42010498046875, 131.8106689453125, 377.8927917480469, 351.008544921875, 531.7868041992188, 195.4006805419922, 568.562744140625, 529.2239379882812, 906.6592407226562, 354.7009582519531, 1213.793212890625, 1036.59130859375, 1771.5111083984375, 958.04736328125, 3333.81103515625, 2533.832763671875, 5751.2431640625, 3940.932373046875, 12259.1904296875, 11062.2841796875, 29256.083984375, 38214.40234375, 118744.359375, 80386.2421875, 144089.53125, 270859.34375, 250498.875]

CIFAR100_mars = [37.49045944213867, 5.858543395996094, 7.3488569259643555, 8.947118759155273, 7.352105617523193, 7.80940055847168, 10.333318710327148, 9.262715339660645, 13.108064651489258, 8.194836616516113, 11.314424514770508, 13.49902629852295, 16.57674217224121, 16.023536682128906, 18.88423728942871, 14.446877479553223, 8.88710880279541, 19.696542739868164, 13.071053504943848, 16.838226318359375, 14.749340057373047, 13.385476112365723, 20.034997940063477, 17.631044387817383, 17.582923889160156, 14.417895317077637, 15.96793270111084, 16.49520492553711, 19.886335372924805, 12.076004028320312, 24.267940521240234, 21.70466423034668, 18.877836227416992, 23.093791961669922, 18.931821823120117, 18.593341827392578, 19.763751983642578, 23.870141983032227, 22.044326782226562, 23.559232711791992, 17.179786682128906, 26.442598342895508, 23.375225067138672, 18.851085662841797, 28.32174301147461, 25.204774856567383, 20.152250289916992, 35.71096420288086, 27.886640548706055, 41.268638610839844, 32.55573272705078, 25.08925437927246, 23.711763381958008, 36.912353515625, 27.802465438842773, 31.760419845581055, 42.61842727661133, 32.06254196166992, 49.54210662841797, 66.71297454833984, 49.30929946899414, 80.01822662353516, 63.521236419677734, 89.8428726196289, 99.48158264160156, 103.4460220336914, 129.58900451660156, 123.34081268310547, 163.79995727539062, 184.7208251953125, 180.58592224121094, 254.38856506347656, 313.5776672363281, 331.5218200683594, 313.5699768066406, 337.62542724609375, 361.7421569824219, 367.5295715332031]

CIFAR10_wide_mars = [2.87971830368042, 4.358943939208984, 3.2648956775665283, 5.547438621520996, 6.147085189819336, 9.736249923706055, 7.1850080490112305, 5.616276741027832, 17.395694732666016, 11.022340774536133, 12.399797439575195, 8.376307487487793, 6.367964267730713, 6.2055487632751465, 7.203463077545166, 14.166680335998535, 13.793684005737305, 13.077630043029785, 10.68739128112793, 20.17011260986328, 12.008129119873047, 13.269018173217773, 17.389188766479492, 10.462775230407715, 13.620124816894531, 12.099940299987793, 12.761619567871094, 13.077496528625488, 13.530752182006836, 19.91718101501465, 15.793620109558105, 15.626007080078125, 12.946094512939453, 8.606512069702148, 20.386760711669922, 7.652846336364746, 21.994478225708008, 17.753467559814453, 13.807559967041016, 17.54454803466797, 16.37065887451172, 17.850631713867188, 15.087435722351074, 24.588497161865234, 13.352457046508789, 27.965625762939453, 28.042888641357422, 18.1534481048584, 26.6906681060791, 28.945388793945312, 24.932743072509766, 28.829612731933594, 29.529699325561523, 24.87837791442871, 31.169939041137695, 38.58544921875, 38.30870056152344, 38.84126663208008, 27.902734756469727, 59.921875, 51.30891418457031, 51.20078659057617, 78.26362609863281, 81.96654510498047, 91.61087036132812, 92.54806518554688, 71.48406982421875, 99.81724548339844, 164.1397247314453, 156.83303833007812, 140.89187622070312, 186.6260986328125, 256.67059326171875, 303.3157043457031, 253.54803466796875, 257.53814697265625, 393.27508544921875, 355.3063049316406]

MNIST_mars = [0.8868357539176941, 3.54386305809021, 13.46508502960205, 20.48773193359375, 22.735334396362305, 13.24384880065918, 21.04838752746582, 27.06361198425293, 24.151851654052734, 18.950754165649414, 47.549072265625, 20.116268157958984, 57.835636138916016, 74.06819915771484, 73.29380798339844, 24.62774085998535, 111.21693420410156, 91.05245208740234, 107.80121612548828, 132.12416076660156, 106.48336791992188, 97.24193572998047, 284.463623046875, 186.69097900390625, 312.2266540527344, 575.4556274414062, 652.0194702148438]

Tolstoi_mars = [0.008533441461622715, 2.3877060413360596, 4.9627766609191895, 9.57036018371582, 10.93666934967041, 18.729045867919922, 15.56439208984375, 10.614213943481445, 14.806585311889648, 18.269317626953125, 20.98405647277832, 14.304559707641602, 25.115921020507812, 42.32296371459961, 29.443584442138672, 37.38033676147461, 49.53410720825195, 58.95287322998047, 53.86463928222656, 98.50200653076172, 115.26631164550781, 97.85814666748047, 151.7604522705078, 240.714111328125, 367.1239013671875, 780.3658447265625, 1647.3056640625]

SVHN_mars = [0.34960272908210754, 12.757801055908203, 12.478523254394531, 1.1552097797393799, 0.46782466769218445, 1.6884831190109253, 0.642259955406189, 0.7299690246582031, 1.577519178390503, 1.1095778942108154, 2.979024648666382, 2.1271564960479736, 1.9462777376174927, 1.438123106956482, 1.7826441526412964, 1.9024821519851685, 2.1091620922088623, 1.6044210195541382, 1.7377057075500488, 4.925995826721191, 2.3064768314361572, 1.0034728050231934, 3.669560432434082, 1.4729008674621582, 1.2898378372192383, 2.436497688293457, 1.0247695446014404, 1.0211443901062012, 3.237452268600464, 1.6258249282836914, 5.123738765716553, 1.1519113779067993, 2.310333490371704, 4.209256172180176, 1.890457272529602, 2.8279316425323486, 3.2598657608032227, 3.214113235473633, 2.870718002319336, 1.5897510051727295, 4.276459217071533, 1.9913978576660156, 2.2641119956970215, 4.474649906158447, 3.9952080249786377, 3.2591776847839355, 2.1989052295684814, 4.031009197235107, 0.9136796593666077, 4.70953893661499, 4.603893756866455, 5.494531154632568, 2.096825361251831, 3.0436553955078125, 3.8599047660827637, 5.72493314743042, 3.5665290355682373, 2.2952115535736084, 4.010359287261963, 1.955365777015686, 5.38015079498291, 3.353632688522339, 4.8658857345581055, 6.017690181732178, 7.70171594619751, 8.62105655670166, 9.298898696899414, 2.4996590614318848, 4.782209396362305, 3.786992311477661, 3.5670082569122314, 10.564926147460938, 11.57512092590332, 5.420751571655273, 8.085951805114746, 8.631797790527344, 17.19070053100586, 7.343105316162109, 13.824726104736328, 11.266851425170898, 27.671438217163086, 30.52273178100586, 77.1424331665039, 96.36969757080078, 212.24703979492188, 897.0755615234375]

def smooth_curve(y, window=5):
    """Simple moving average smoothing."""
    if len(y) < window:
        return y  # donâ€™t smooth if shorter than window
    return np.convolve(y, np.ones(window)/window, mode="same")

plt.figure(figsize=(8, 5))
#plt.semilogy(range(len(MNIST_norm)),smooth_curve(MNIST_norm), label="MNIST MLP", color="C4")
#plt.semilogy(range(len(SVHN_norm)),smooth_curve(SVHN_norm), label="SVHN Deep-CNN", color="C5")
#plt.semilogy(range(len(Tolstoi_norm)),smooth_curve(Tolstoi_norm), label="Tolstoi RNN", color="C2")
#plt.semilogy(range(len(CIFAR10_wide_norm)),smooth_curve(CIFAR10_wide_norm), label="CIFAR10 Wide-ResNET", color="C7")
#plt.semilogy(range(len(CIFAR100_norm)),smooth_curve(CIFAR100_norm), label="CIFAR100 ResNET", color="C3")

plt.semilogy(range(len(MNIST_norm)),MNIST_norm, label="MNIST", color="C4")
plt.semilogy(range(len(SVHN_norm)),SVHN_norm, label="SVHN", color="C5")
plt.semilogy(range(len(Tolstoi_norm)),Tolstoi_norm, label="Tolstoi", color="C2")
plt.semilogy(range(len(CIFAR10_wide_norm)),CIFAR10_wide_norm, label="CIFAR10", color="C7")
plt.semilogy(range(len(CIFAR100_norm)),CIFAR100_norm, label="CIFAR100 ResNet", color="C3")

#plt.semilogy(range(len(MNIST_mars)),smooth_curve(MNIST_mars), color="C4", linestyle="dashed")
#plt.semilogy(range(len(SVHN_mars)),smooth_curve(SVHN_mars), color="C5", linestyle="dashed")
#plt.semilogy(range(len(Tolstoi_mars)),smooth_curve(Tolstoi_mars), color="C2", linestyle="dashed")
#plt.semilogy(range(len(CIFAR10_wide_mars)),smooth_curve(CIFAR10_wide_mars), color="C7", linestyle="dashed")
#plt.semilogy(range(len(CIFAR100_mars)),smooth_curve(CIFAR100_mars), color="C3", linestyle="dashed")
plt.ylim((0.006,0.5*10**6))
plt.ylabel("Minibatch variance")
plt.xlabel("Steps (x1000)")
plt.legend()
plt.savefig("compare_variances.png", dpi=500)

