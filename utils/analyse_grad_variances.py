import matplotlib.pyplot as plt
plt.rcParams['font.size'] = 13
plt.rcParams['font.family'] = 'serif'
true = [2.1217172161414055e-06, 7.37819345886237e-06, 5.159206921234727e-06, 4.8378419705841225e-06, 4.367280325823231e-06, 3.721849680005107e-06, 3.4156287256337237e-06, 6.248621502891183e-06, 2.6410796181153273e-06, 1.340706376140588e-06, 9.460069918532099e-07, 5.463332968247414e-07, 4.352585847300361e-07, 2.741389550919848e-07, 1.8806015589234448e-07, 2.1242883008198987e-07, 4.659249697169798e-08, 6.216674819370382e-08, 1.6902587773870437e-08, 1.3413142596618854e-08, 1.4523022784374007e-08, 7.511642863278212e-09, 7.68473906731515e-09, 6.208733527302002e-09, 5.247639656147385e-09, 5.077402942532672e-09, 5.064520358644131e-09]
ten = [2.0394381863297895e-06, 6.893684258102439e-06, 3.157915898555075e-06, 2.7070311716670403e-06, 3.3412184166081715e-06, 2.83457052319136e-06, 3.829022716672625e-06, 1.4243797750168596e-06, 1.4628717508458067e-06, 1.1994511623925064e-06, 2.4022912725740753e-07, 3.0539126782969106e-07, 2.545455970448529e-07, 3.830317041320086e-08, 3.657551417290961e-08, 5.427005067559776e-09, 9.860431582353613e-09, 2.3585670305692474e-08, 2.556815559273673e-08, 4.910698514493106e-09, 7.250392730639987e-09, 3.6394398605921197e-09, 4.266424991072881e-09, 5.130067037839581e-09, 8.213032032244882e-09, 6.1242624305180016e-09, 1.2500100510237644e-08]
five = [1.3120610447003855e-06, 1.1018430086551234e-05, 4.657352292269934e-06, 2.700194954741164e-06, 2.7792550554295303e-06, 2.6822588097275e-06, 1.4254617326514563e-06, 9.330304919785704e-07, 5.580890274359263e-07, 1.6047771396188182e-06, 1.0258109739424981e-07, 6.303084632008904e-08, 6.483433168114061e-08, 2.1890411261438203e-08, 3.314717744729023e-08, 1.3214402905248335e-08, 1.0897686308908305e-08, 4.869141978502967e-09, 1.1742244510060118e-08, 5.1616231289131065e-09, 6.377968375659293e-09, 8.993995770367746e-09, 2.190223291620441e-08, 4.352474824997898e-09, 2.3323301068245428e-09, 7.961053150040698e-09, 4.521262031431661e-09]
twenty = [1.9721737771760672e-06, 7.23418179404689e-06, 6.382463652698789e-06, 4.423337486514356e-06, 4.229138994560344e-06, 2.684159881027881e-06, 1.4835155752734863e-06, 1.7366838847010513e-06, 1.3487791648003622e-06, 1.0198323252552655e-06, 7.760016274005466e-07, 3.04714404819606e-07, 6.934765792721009e-07, 1.4479970111835883e-08, 4.24400283804971e-08, 2.8982897859464174e-08, 1.9364888359518773e-08, 7.480263519710206e-09, 3.0764255143367336e-08, 4.582505930272873e-09, 4.181208712594753e-09, 1.3620244487810851e-08, 5.592227125816862e-09, 4.9973154503391015e-09, 3.9653484940060935e-09, 3.931516001642876e-09, 3.72202957343859e-09]
fifty = [1.6423792885689181e-06, 8.296990927192383e-06, 6.060570740373805e-06, 3.7216298096609535e-06, 4.94970845466014e-06, 4.449807875062106e-06, 3.5860484786098823e-06, 2.888456037908327e-06, 2.910038574555074e-06, 1.3243379726191051e-06, 1.1008045248672715e-06, 5.229664452599536e-07, 1.1943948265979998e-06, 1.777208069597691e-07, 1.9465993261746917e-07, 2.804223697694397e-07, 4.439876732931225e-08, 8.607130297377807e-08, 4.5440074813996034e-08, 1.704862384599437e-08, 2.517659680734141e-08, 1.1061573879089792e-08, 8.898625836195606e-09, 1.0799213079337733e-08, 4.5477124288595405e-09, 6.0421960768053395e-09, 7.155068981745671e-09]
fivehundred = [2.103806309605716e-06, 6.8372728492249735e-06, 5.0162384468421806e-06, 4.005049504485214e-06, 4.0181776057579555e-06, 4.272681962902425e-06, 2.640412049004226e-06, 3.6469295991992112e-06, 3.5178702546545537e-06, 1.896816911539645e-06, 1.9647554836410563e-06, 5.167810286366148e-07, 4.624701261946029e-07, 2.264503251581118e-07, 3.786331603805593e-07, 2.3929788994792034e-07, 2.164827037631767e-07, 2.7463952889661414e-08, 3.7701841648640766e-08, 2.4471187742847178e-08, 1.5859084712133154e-08, 1.4075870247154398e-08, 8.550364860582249e-09, 8.036221466056759e-09, 7.46577022425754e-09, 7.074288266295525e-09, 6.8344445658397035e-09]

MNIST = [2.016000962612452e-06, 7.351318345172331e-06, 5.554922609007917e-06, 4.797378551302245e-06, 3.942524472222431e-06, 4.352619725978002e-06, 4.953618372383062e-06, 5.950232662144117e-06, 2.3400293684971984e-06, 1.7182483134092763e-06, 1.0975529676215956e-06, 9.153076234724722e-07, 3.3914685104718956e-07, 3.9405296092809294e-07, 3.2049334208750224e-07, 1.867405075017814e-07, 1.0286598950415282e-07, 7.651588873613946e-08, 2.484796013391133e-08, 1.8780836441578685e-08, 1.634643709280681e-08, 1.0683654849685809e-08, 8.279048557824353e-09, 7.404041379999171e-09, 5.721187967822061e-09, 5.4512012681584565e-09, 5.44233413890538e-09]
SVHN = [8.423070596563775e-08, 2.441746005388268e-07, 2.3229467842611484e-06, 6.395664968295023e-05, 7.841273327358067e-05, 9.433789091417566e-05, 7.579478551633656e-05, 6.372846110025421e-05, 4.320843436289579e-05, 4.533297396847047e-05, 3.4905569918919355e-05, 3.4725326258921996e-05, 5.033676279708743e-05, 3.148262112517841e-05, 3.532346818246879e-05, 4.021757558803074e-05, 3.7552250432781875e-05, 4.054300734424032e-05, 3.2312153052771464e-05, 3.015293987118639e-05, 4.02767545892857e-05, 3.693363760248758e-05, 3.595720409066416e-05, 3.392538565094583e-05, 3.426114926696755e-05, 3.353368811076507e-05, 3.3127464121207595e-05]
Tolstoi = [2.4913222596012474e-09, 1.1165278834823766e-07, 1.7894346626690094e-07, 2.1640862257754634e-07, 2.3322822073623684e-07, 2.491000827831158e-07, 2.593464500932896e-07, 2.6502831929064996e-07, 2.6789254548020836e-07, 2.7433239324636816e-07, 2.764286364254076e-07, 2.818298412421427e-07, 2.81269024071662e-07, 2.8276252805881086e-07, 2.8529163387247536e-07, 2.832420022969018e-07, 2.8507886895567935e-07, 2.866487989194866e-07, 2.8844743837908027e-07, 2.8861879286523617e-07, 2.8830581300098856e-07, 2.8941991558895097e-07, 2.905787255258474e-07, 2.9027157211203303e-07, 2.911280319040088e-07, 2.914204912940477e-07, 2.915931531788374e-07]
CIFAR10_wide = [3.1440563930118515e-07, 9.42560632211098e-07, 6.185028382788005e-07, 5.534988076760783e-07, 4.973064164914831e-07, 5.523080517377821e-07, 4.5120486902305856e-07, 4.4353359385240765e-07, 5.23324047208007e-07, 5.031945420341799e-07, 5.501000259755529e-07, 5.262969580144272e-07, 5.360645900509553e-07, 5.898096446799173e-07, 5.732620138587663e-07, 6.732732913405926e-07, 6.549533964061993e-07, 7.453106718458002e-07, 7.948236202537373e-07, 9.951106676453492e-07, 9.892258958643652e-07, 9.011880592879606e-07, 1.038226400851272e-06, 1.0611632887957967e-06, 1.0636022125254385e-06, 1.0521953299758025e-06, 1.0992636134687928e-06, 1.176198907160142e-06, 1.032269324241497e-06, 1.3099810303174309e-06, 1.2259383765922394e-06, 1.271141059078218e-06, 1.1037742524422356e-06, 1.2147992265454377e-06, 1.351755145151401e-06, 1.2594656482178834e-06, 1.2821933523810003e-06, 1.2348214113444556e-06, 1.229452209372539e-06, 1.2080321312168962e-06, 1.355767039967759e-06, 1.2397212003634195e-06, 1.351192736365192e-06, 1.4312089433587971e-06, 1.3169945987101528e-06, 1.3340544455786585e-06, 1.2016449773000204e-06, 1.3063817050351645e-06, 1.3226275541455834e-06, 1.415203314536484e-06, 1.3746619060839294e-06, 1.3545576393880765e-06, 1.2940988654008834e-06, 1.400752353220014e-06, 1.2926859653816791e-06, 1.18809668947506e-06, 1.1194174476258922e-06, 1.2316920674493304e-06, 1.1252240028625238e-06, 1.2891015330751543e-06, 1.002433009489323e-06, 9.464736763220571e-07, 8.676531138007704e-07, 8.716168053979345e-07, 8.153113526532252e-07, 8.263863833235519e-07, 7.205732117654406e-07, 7.41538940474129e-07, 6.525535809487337e-07, 6.136786510069214e-07, 6.678290560557798e-07, 6.024894787515223e-07, 6.141573862805672e-07, 5.565365199799999e-07, 5.604519515145512e-07, 4.97021403589315e-07, 5.343447355699027e-07, 5.195473704588949e-07]
CIFAR100 = [4.688272838393459e-06, 2.2641977466264507e-06, 1.5210030142043252e-06, 1.3574151580542093e-06, 1.336908439952822e-06, 1.2466048247006256e-06, 1.3143426258466206e-06, 1.2403344271660899e-06, 1.35539175971644e-06, 1.325188236478425e-06, 1.4266855714595295e-06, 1.4692004697280936e-06, 1.6044356243583024e-06, 1.7073358549168915e-06, 1.8653902316145832e-06, 1.8862856450141408e-06, 1.997644631046569e-06, 2.1412627120298566e-06, 2.366394710406894e-06, 2.5253880266973283e-06, 2.5266947432101006e-06, 2.711905381147517e-06, 2.6949010134558193e-06, 2.800044285322656e-06, 2.900562094509951e-06, 3.067081252083881e-06, 3.1582305837218883e-06, 3.105534005953814e-06, 3.404260041861562e-06, 3.2525003916816786e-06, 3.4250665521540213e-06, 3.319094957987545e-06, 3.3276087378908414e-06, 3.5425664464128204e-06, 3.6228382214176236e-06, 3.7590282317978563e-06, 3.680036343212123e-06, 3.50142454408342e-06, 3.6497142446023645e-06, 3.5893460790248355e-06, 3.6887199712509755e-06, 3.7686243103962624e-06, 3.8133821362862363e-06, 3.591462473195861e-06, 3.951834059989778e-06, 3.680805775729823e-06, 3.5501952879712917e-06, 3.409243163332576e-06, 3.3911830996657955e-06, 3.3330875339743216e-06, 3.6728517898154678e-06, 3.32261151925195e-06, 3.3516244002385065e-06, 3.2947102681646356e-06, 2.9744360290351324e-06, 2.932989900727989e-06, 2.8849101454397896e-06, 2.654573563631857e-06, 2.583030436653644e-06, 2.6626796625350835e-06, 2.277333123856806e-06, 2.1682553779101e-06, 2.2655474367638817e-06, 2.0164850411674706e-06, 1.927749281094293e-06, 1.8211665064882254e-06, 1.7627519355301047e-06, 1.648571242185426e-06, 1.4735245486008353e-06, 1.4792125284657232e-06, 1.5516075109189842e-06, 1.449571868761268e-06, 1.4175092246659915e-06, 1.259757368643477e-06, 1.1939433761654072e-06, 1.2755532452501939e-06, 1.323583319390309e-06, 1.2497525858634617e-06]


CIFAR100_n = [52.05611038208008, 51.68265151977539, 61.44646072387695, 60.09184265136719, 49.6096305847168, 43.04046630859375, 42.261051177978516, 40.14726638793945, 41.72893524169922, 40.52005386352539, 42.96952819824219, 44.228515625, 45.96077346801758, 49.6119270324707, 54.185611724853516, 55.81826400756836, 58.847740173339844, 63.439544677734375, 68.08069610595703, 73.72591400146484, 80.46272277832031, 86.21161651611328, 90.4227523803711, 100.1921157836914, 105.98104095458984, 116.20409393310547, 118.16670989990234, 128.7168426513672, 136.16651916503906, 135.839599609375, 151.36083984375, 158.74612426757812, 163.2427215576172, 172.81922912597656, 173.57470703125, 181.77809143066406, 190.124755859375, 192.65203857421875, 209.1897735595703, 213.7644805908203, 212.70196533203125, 223.399658203125, 221.49276733398438, 213.7992401123047, 222.41973876953125, 223.65321350097656, 231.5583038330078, 237.4443359375, 239.29493713378906, 236.49826049804688, 240.56134033203125, 228.6750946044922, 205.43821716308594, 223.22747802734375, 210.82972717285156, 204.70040893554688, 201.19252014160156, 191.99900817871094, 186.42794799804688, 188.17431640625, 180.32891845703125, 172.47006225585938, 164.9738311767578, 156.9653778076172, 152.78208923339844, 140.92047119140625, 138.08224487304688, 130.17684936523438, 124.77938079833984, 114.82752227783203, 112.78521728515625, 108.29779052734375, 114.6268081665039, 98.85913848876953, 102.23302459716797, 99.40897369384766, 100.31875610351562, 95.90695190429688]
CIFAR10_wide_n = [3.7658870220184326, 4.880433082580566, 1.4052927494049072, 0.693889319896698, 0.41546452045440674, 0.4171885550022125, 0.4343484044075012, 0.40004825592041016, 0.4520115852355957, 0.5717809200286865, 0.5731943249702454, 0.5840466022491455, 0.5995479226112366, 0.6236701607704163, 0.5777467489242554, 0.5732412338256836, 0.5452774167060852, 0.5889450311660767, 0.5641880631446838, 0.5954475402832031, 0.65337735414505, 0.6600508689880371, 0.6889400482177734, 0.5815934538841248, 0.718733549118042, 0.5511582493782043, 0.6396375298500061, 0.686326801776886, 0.637980043888092, 0.7705657482147217, 0.7187985181808472, 0.7397973537445068, 0.7923426032066345, 0.7583488821983337, 0.8263338804244995, 0.7831600308418274, 0.7792416214942932, 0.7971193790435791, 0.825068473815918, 0.8676949739456177, 0.8270394802093506, 0.8603066205978394, 0.9824929237365723, 0.9510558843612671, 0.9015406370162964, 0.9206352233886719, 0.8581973910331726, 1.0515475273132324, 0.9929520487785339, 1.0775011777877808, 0.9697129726409912, 0.9757195711135864, 1.2127858400344849, 1.0945864915847778, 1.0086463689804077, 0.9301995635032654, 0.9946821331977844, 0.9906653165817261, 1.0139269828796387, 1.007493019104004, 1.014556646347046, 0.7719795107841492, 0.73051917552948, 0.7562285661697388, 0.6446717381477356, 0.5902835130691528, 0.5441939234733582, 0.6128835678100586, 0.4942934811115265, 0.4757120609283447, 0.47144919633865356, 0.38244977593421936, 0.4308183789253235, 0.42564818263053894, 0.3342863917350769, 0.33980002999305725, 0.4189766049385071, 0.374724417924881]
MNIST_n = [0.22804096341133118, 0.7523034811019897, 0.45021697878837585, 0.5144185423851013, 0.46813079714775085, 0.35379892587661743, 0.3648298382759094, 0.36550173163414, 0.3510442078113556, 0.36623409390449524, 0.5294081568717957, 0.26130810379981995, 0.33843469619750977, 0.46174564957618713, 0.34802502393722534, 0.24506808817386627, 0.2631256580352783, 0.2674161493778229, 0.18794561922550201, 0.14447109401226044, 0.1511654108762741, 0.06937142461538315, 0.06445547193288803, 0.06357099860906601, 0.026440367102622986, 0.017624137923121452, 0.015992218628525734]
Tolstoi_n = [0.000721973367035389, 0.041239067912101746, 0.03827481344342232, 0.03501215949654579, 0.03244686499238014, 0.03190841153264046, 0.029690813273191452, 0.029777906835079193, 0.028512543067336082, 0.02799050323665142, 0.027922628447413445, 0.0283226128667593, 0.02794109284877777, 0.02760368399322033, 0.027122825384140015, 0.02724675089120865, 0.0276823528110981, 0.02799142524600029, 0.02803107351064682, 0.02806919999420643, 0.0281996913254261, 0.028049282729625702, 0.02817911095917225, 0.028484705835580826, 0.02854827418923378, 0.02852621115744114, 0.028576655313372612]
SVHN_n = [0.008429449051618576, 0.036414578557014465, 0.034984733909368515, 0.032805994153022766, 5.871289253234863, 11.134122848510742, 40.256961822509766, 37.470787048339844, 44.40251922607422, 36.36854934692383, 29.660425186157227, 17.508024215698242, 14.13369369506836, 11.67212200164795, 8.356118202209473, 8.460779190063477, 9.76628303527832, 10.749594688415527, 6.684730529785156, 7.581116199493408, 7.483274936676025, 12.031750679016113, 9.503541946411133, 6.120401382446289, 9.156210899353027, 7.275237083435059, 7.333486080169678, 9.020054817199707, 6.9326090812683105, 11.3633394241333, 8.591266632080078, 7.137136936187744, 6.053144454956055, 9.058345794677734, 8.164571762084961, 7.2084269523620605, 10.56197452545166, 8.261977195739746, 9.13127326965332, 9.146824836730957, 9.4542875289917, 8.237271308898926, 8.797911643981934, 9.500255584716797, 8.276418685913086, 9.24637508392334, 8.03166389465332, 11.230230331420898, 9.977569580078125, 16.19881820678711, 12.477118492126465, 13.549960136413574, 10.931954383850098, 19.099857330322266, 12.3154878616333, 10.920701026916504, 17.57377815246582, 12.611289978027344, 15.187353134155273, 10.795661926269531, 16.25523567199707, 13.038064002990723, 12.425268173217773, 11.98216438293457, 17.362689971923828, 13.323622703552246, 12.710646629333496, 14.334417343139648, 14.170890808105469, 13.985564231872559, 15.301875114440918, 14.727270126342773, 15.095541000366211, 14.784112930297852, 13.970438003540039, 13.747108459472656, 13.984400749206543, 13.934511184692383, 13.881614685058594, 13.89915657043457, 13.779236793518066, 13.354736328125, 13.335867881774902, 13.552838325500488, 13.372139930725098, 13.40501594543457]


plt.figure()
plt.semilogy(range(len(MNIST_n)),MNIST_n, label="MNIST MLP")
plt.semilogy(range(len(SVHN_n)),SVHN_n, label="SVHN Deep-CNN")
plt.semilogy(range(len(Tolstoi_n)),Tolstoi_n, label="Tolstoi RNN")
plt.semilogy(range(len(CIFAR10_wide_n)),CIFAR10_wide_n, label="CIFAR10 Wide-ResNET")
plt.semilogy(range(len(CIFAR100_n)),CIFAR100_n, label="CIFAR100 ResNET")


plt.ylabel("Minibatch variance")
plt.xlabel("Steps (x1000)")
plt.legend()
plt.savefig("compare_variances.png", dpi=500)

