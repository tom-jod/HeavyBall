import matplotlib.pyplot as plt
import numpy as np

# Data extraction
# Simple External (PyTorch AdamW)
simple_external_steps = np.array([0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 99])
simple_external_losses = np.array([2.7276, 0.1351, 0.0094, 0.0022, 0.0011, 0.0008, 0.0006, 0.0006, 0.0005, 0.0005, 0.0004])
simple_external_losses = np.array([2.7275943756103516, 0.1350896805524826, 0.009393624030053616, 0.00215734401717782, 0.0010668266331776977, 0.0007541134837083519, 0.0006237501511350274, 0.0005519390106201172, 0.0005027562729083002, 0.00046392137301154435, 0.00043372102663852274])
# NadamW
#simple_external_losses = np.array([2.7275943756103516, 0.06616045534610748, 0.006584743037819862, 0.001999011030420661, 0.001108025899156928, 0.0008139206329360604, 0.0006783768767490983, 0.0005977867403998971, 0.0005398623761720955, 0.000493198458570987, 0.0004570022283587605])
#Shampoo
simple_external_losses = np.array([2.7275943756103516, 0.13758030533790588, 0.010088762268424034, 0.002548371674492955, 0.0013168341247364879, 0.0009433624800294638, 0.0007781853782944381, 0.0006818650290369987, 0.0006111559923738241, 0.0005549309425987303, 0.0005125210736878216])

# HB External (HeavyBall with External AdamW)
hb_external_steps = np.arange(10) * 10  # Scale to match step intervals
hb_external_losses = np.array([2.808232545852661, 0.12858761847019196, 0.008995084092020988, 0.0021696542389690876, 0.0010934412712231278, 0.0007776351412758231, 0.0006447727209888399, 0.0005710122059099376, 0.0005204502958804369, 0.00048055374645628035])
hb_external_losses = np.array([2.7275943756103516, 0.1350896805524826, 0.009393624030053616, 0.00215734401717782, 0.0010668266331776977, 0.0007541134837083519, 0.0006237501511350274, 0.0005519390106201172, 0.0005027562729083002, 0.00046392137301154435])
# NadamW
#hb_external_losses = np.array([2.7275943756103516, 0.06616045534610748, 0.006584743037819862, 0.001999011030420661, 0.001108025899156928, 0.0008139206329360604, 0.0006783768767490983, 0.0005977867403998971, 0.0005398623761720955, 0.000493198458570987])
#Shampoo
hb_losses = np.array([2.7275943756103516, 0.1350896805524826, 0.009393624030053616, 0.00215734401717782, 0.0010668266331776977, 0.0007541134837083519, 0.0006237501511350274, 0.0005519390106201172, 0.0005027562729083002, 0.00046392137301154435])

# HB (HeavyBall with custom AdamW)
hb_steps = np.arange(10) * 10  # Scale to match step intervals
hb_losses = np.array([2.808232545852661, 0.9160979390144348, 0.4183022975921631, 0.2180427759885788, 0.13227024674415588, 0.09127303957939148, 0.06882411986589432, 0.0551774837076664, 0.046044524759054184, 0.039516061544418335])
hb_losses = np.array([2.7275943756103516, 0.8785368204116821, 0.42073407769203186, 0.22887706756591797, 0.1399337202310562, 0.09584905952215195, 0.07167119532823563, 0.057012904435396194, 0.04728870466351509, 0.04038539528846741])
# NadamW
#hb_losses = np.array([2.7275943756103516, 0.08933410048484802, 0.0064745573326945305, 0.0020893425680696964, 0.0011420054361224174, 0.0007332271197810769, 0.0005033091292716563, 0.00036047594039700925, 0.000266922201262787, 0.00020330259576439857])
#Shampoo
hb_losses = np.array([2.7275943756103516, 0.11470020562410355, 0.0011911278124898672, 5.2447965572355315e-05, 1.0536633453739341e-05, 4.744081707031e-06, 3.1776392006577225e-06, 2.5816048037086148e-06, 2.2891747448738897e-06, 2.1252649275993463e-06])


plt.figure(figsize=(12, 8))
plt.plot(simple_external_steps, simple_external_losses, 'r-o', label='Simple External (PyTorch)', linewidth=2.5, markersize=8)
plt.plot(hb_external_steps, hb_external_losses, 'b-s', label='HB External (HeavyBall + PyTorch)', linewidth=2.5, markersize=8)
plt.plot(hb_steps, hb_losses, 'g-^', label='HB (HeavyBall + Custom)', linewidth=2.5, markersize=8)

plt.xlabel('Training Steps', fontsize=14)
plt.ylabel('Training Loss (log scale)', fontsize=14)
plt.title('Training Loss Comparison', fontsize=16, fontweight='bold')
plt.legend(fontsize=12)
plt.grid(True, alpha=0.3)
plt.yscale('log')
plt.xlim(0, 100)

plt.tight_layout()
plt.savefig("loss_comp")